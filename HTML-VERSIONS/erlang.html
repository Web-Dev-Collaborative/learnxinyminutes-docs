<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>erlang.html</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<div class="sourceCode" id="cb1"><pre class="sourceCode erlang"><code class="sourceCode erlang"><a class="sourceLine" id="cb1-1" title="1"><span class="co">% Percent sign starts a one-line comment.</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">%% Two percent characters shall be used to comment functions.</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">%%% Three percent characters shall be used to comment modules.</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">% We use three types of punctuation in Erlang.</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">% Commas (`,`) separate arguments in function calls, data constructors, and</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">% patterns.</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">% Periods (`.`) (followed by whitespace) separate entire functions and</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">% expressions in the shell.</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">% Semicolons (`;`) separate clauses. We find clauses in several contexts:</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">% function definitions and in `case`, `if`, `try..catch`, and `receive`</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">% expressions.</span></a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">%% 1. Variables and pattern matching.</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">% In Erlang new variables are bound with an `=` statement.</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="va">Num</span> <span class="op">=</span> <span class="dv">42</span><span class="fu">.</span>  <span class="co">% All variable names must start with an uppercase letter.</span></a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">% Erlang has single-assignment variables; if you try to assign a different</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">% value to the variable `Num`, you’ll get an error.</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="va">Num</span> <span class="op">=</span> <span class="dv">43</span><span class="fu">.</span> <span class="co">% ** exception error: no match of right hand side value 43</span></a>
<a class="sourceLine" id="cb1-26" title="26"></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">% In most languages, `=` denotes an assignment statement. In Erlang, however,</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">% `=` denotes a pattern-matching operation. When an empty variable is used on the</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">% left hand side of the `=` operator to is bound (assigned), but when a bound</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">% variable is used on the left hand side the following behaviour is observed.</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">% `Lhs = Rhs` really means this: evaluate the right side (`Rhs`), and then</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">% match the result against the pattern on the left side (`Lhs`).</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="va">Num</span> <span class="op">=</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">6</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-34" title="34"></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">% Floating-point number.</span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="va">Pi</span> <span class="op">=</span> <span class="fl">3.14159</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-37" title="37"></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">% Atoms are used to represent different non-numerical constant values. Atoms</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">% start with lowercase letters, followed by a sequence of alphanumeric</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">% characters or the underscore (`_`) or at (`@`) sign.</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="va">Hello</span> <span class="op">=</span> <span class="ch">hello</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="va">OtherNode</span> <span class="op">=</span> <span class="ch">example@node</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-43" title="43"></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">% Atoms with non alphanumeric values can be written by enclosing the atoms</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co">% with apostrophes.</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="va">AtomWithSpace</span> <span class="op">=</span> <span class="ch">&#39;some atom with space&#39;</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-47" title="47"></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co">% Tuples are similar to structs in C.</span></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="va">Point</span> <span class="op">=</span> <span class="fu">{</span><span class="ch">point</span><span class="fu">,</span> <span class="dv">10</span><span class="fu">,</span> <span class="dv">45</span><span class="fu">}.</span></a>
<a class="sourceLine" id="cb1-50" title="50"></a>
<a class="sourceLine" id="cb1-51" title="51"><span class="co">% If we want to extract some values from a tuple, we use the pattern-matching</span></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="co">% operator `=`.</span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="fu">{</span><span class="ch">point</span><span class="fu">,</span> <span class="va">X</span><span class="fu">,</span> <span class="va">Y</span><span class="fu">}</span> <span class="op">=</span> <span class="va">Point</span><span class="fu">.</span>  <span class="co">% X = 10, Y = 45</span></a>
<a class="sourceLine" id="cb1-54" title="54"></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="co">% We can use `_` as a placeholder for variables that we’re not interested in.</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="co">% The symbol `_` is called an anonymous variable. Unlike regular variables,</span></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="co">% several occurrences of `_` in the same pattern don’t have to bind to the</span></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="co">% same value.</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="va">Person</span> <span class="op">=</span> <span class="fu">{</span><span class="ch">person</span><span class="fu">,</span> <span class="fu">{</span><span class="ch">name</span><span class="fu">,</span> <span class="fu">{</span><span class="ch">first</span><span class="fu">,</span> <span class="ch">joe</span><span class="fu">},</span> <span class="fu">{</span><span class="ch">last</span><span class="fu">,</span> <span class="ch">armstrong</span><span class="fu">}},</span> <span class="fu">{</span><span class="ch">footsize</span><span class="fu">,</span> <span class="dv">42</span><span class="fu">}}.</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="fu">{</span>_<span class="fu">,</span> <span class="fu">{</span>_<span class="fu">,</span> <span class="fu">{</span>_<span class="fu">,</span> <span class="va">Who</span><span class="fu">},</span> <span class="va">_</span><span class="fu">},</span> <span class="va">_</span><span class="fu">}</span> <span class="op">=</span> <span class="va">Person</span><span class="fu">.</span>  <span class="co">% Who = joe</span></a>
<a class="sourceLine" id="cb1-61" title="61"></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="co">% We create a list by enclosing the list elements in square brackets and</span></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="co">% separating them with commas.</span></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="co">% The individual elements of a list can be of any type.</span></a>
<a class="sourceLine" id="cb1-65" title="65"><span class="co">% The first element of a list is the head of the list. If you imagine removing</span></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="co">% the head from the list, what’s left is called the tail of the list.</span></a>
<a class="sourceLine" id="cb1-67" title="67"><span class="va">ThingsToBuy</span> <span class="op">=</span> <span class="fu">[{</span><span class="ch">apples</span><span class="fu">,</span> <span class="dv">10</span><span class="fu">},</span> <span class="fu">{</span><span class="ch">pears</span><span class="fu">,</span> <span class="dv">6</span><span class="fu">},</span> <span class="fu">{</span><span class="ch">milk</span><span class="fu">,</span> <span class="dv">3</span><span class="fu">}].</span></a>
<a class="sourceLine" id="cb1-68" title="68"></a>
<a class="sourceLine" id="cb1-69" title="69"><span class="co">% If `T` is a list, then `[H|T]` is also a list, with head `H` and tail `T`.</span></a>
<a class="sourceLine" id="cb1-70" title="70"><span class="co">% The vertical bar (`|`) separates the head of a list from its tail.</span></a>
<a class="sourceLine" id="cb1-71" title="71"><span class="co">% `[]` is the empty list.</span></a>
<a class="sourceLine" id="cb1-72" title="72"><span class="co">% We can extract elements from a list with a pattern-matching operation. If we</span></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="co">% have a nonempty list `L`, then the expression `[X|Y] = L`, where `X` and `Y`</span></a>
<a class="sourceLine" id="cb1-74" title="74"><span class="co">% are unbound variables, will extract the head of the list into `X` and the tail</span></a>
<a class="sourceLine" id="cb1-75" title="75"><span class="co">% of the list into `Y`.</span></a>
<a class="sourceLine" id="cb1-76" title="76"><span class="fu">[</span><span class="va">FirstThing</span><span class="fu">|</span><span class="va">OtherThingsToBuy</span><span class="fu">]</span> <span class="op">=</span> <span class="va">ThingsToBuy</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="co">% FirstThing = {apples, 10}</span></a>
<a class="sourceLine" id="cb1-78" title="78"><span class="co">% OtherThingsToBuy = [{pears, 6}, {milk, 3}]</span></a>
<a class="sourceLine" id="cb1-79" title="79"></a>
<a class="sourceLine" id="cb1-80" title="80"><span class="co">% There are no strings in Erlang. Strings are really just lists of integers.</span></a>
<a class="sourceLine" id="cb1-81" title="81"><span class="co">% Strings are enclosed in double quotation marks (`&quot;`).</span></a>
<a class="sourceLine" id="cb1-82" title="82"><span class="va">Name</span> <span class="op">=</span> <span class="st">&quot;Hello&quot;</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-83" title="83"><span class="fu">[</span><span class="dv">72</span><span class="fu">,</span> <span class="dv">101</span><span class="fu">,</span> <span class="dv">108</span><span class="fu">,</span> <span class="dv">108</span><span class="fu">,</span> <span class="dv">111</span><span class="fu">]</span> <span class="op">=</span> <span class="st">&quot;Hello&quot;</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-84" title="84"></a>
<a class="sourceLine" id="cb1-85" title="85"></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="co">%% 2. Sequential programming.</span></a>
<a class="sourceLine" id="cb1-88" title="88"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-89" title="89"></a>
<a class="sourceLine" id="cb1-90" title="90"><span class="co">% Modules are the basic unit of code in Erlang. All the functions we write are</span></a>
<a class="sourceLine" id="cb1-91" title="91"><span class="co">% stored in modules. Modules are stored in files with `.erl` extensions.</span></a>
<a class="sourceLine" id="cb1-92" title="92"><span class="co">% Modules must be compiled before the code can be run. A compiled module has the</span></a>
<a class="sourceLine" id="cb1-93" title="93"><span class="co">% extension `.beam`.</span></a>
<a class="sourceLine" id="cb1-94" title="94"><span class="kw">-module</span><span class="fu">(</span><span class="ch">geometry</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-95" title="95"><span class="kw">-export</span><span class="fu">([</span><span class="ch">area</span><span class="op">/</span><span class="dv">1</span><span class="fu">]).</span> <span class="co">% the list of functions exported from the module.</span></a>
<a class="sourceLine" id="cb1-96" title="96"></a>
<a class="sourceLine" id="cb1-97" title="97"><span class="co">% The function `area` consists of two clauses. The clauses are separated by a</span></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="co">% semicolon, and the final clause is terminated by dot-whitespace.</span></a>
<a class="sourceLine" id="cb1-99" title="99"><span class="co">% Each clause has a head and a body; the head consists of a function name</span></a>
<a class="sourceLine" id="cb1-100" title="100"><span class="co">% followed by a pattern (in parentheses), and the body consists of a sequence of</span></a>
<a class="sourceLine" id="cb1-101" title="101"><span class="co">% expressions, which are evaluated if the pattern in the head is successfully</span></a>
<a class="sourceLine" id="cb1-102" title="102"><span class="co">% matched against the calling arguments. The patterns are matched in the order</span></a>
<a class="sourceLine" id="cb1-103" title="103"><span class="co">% they appear in the function definition.</span></a>
<a class="sourceLine" id="cb1-104" title="104"><span class="fu">area({</span><span class="ch">rectangle</span><span class="fu">,</span> <span class="va">Width</span><span class="fu">,</span> <span class="va">Ht</span><span class="fu">})</span> <span class="op">-&gt;</span> <span class="va">Width</span> <span class="op">*</span> <span class="va">Ht</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-105" title="105"><span class="fu">area({</span><span class="ch">circle</span><span class="fu">,</span> <span class="va">R</span><span class="fu">})</span>            <span class="op">-&gt;</span> <span class="fl">3.14159</span> <span class="op">*</span> <span class="va">R</span> <span class="op">*</span> <span class="va">R</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-106" title="106"></a>
<a class="sourceLine" id="cb1-107" title="107"><span class="co">% Compile the code in the file geometry.erl.</span></a>
<a class="sourceLine" id="cb1-108" title="108"><span class="fu">c(</span><span class="ch">geometry</span><span class="fu">).</span>  <span class="co">% {ok,geometry}</span></a>
<a class="sourceLine" id="cb1-109" title="109"></a>
<a class="sourceLine" id="cb1-110" title="110"><span class="co">% We need to include the module name together with the function name in order to</span></a>
<a class="sourceLine" id="cb1-111" title="111"><span class="co">% identify exactly which function we want to call.</span></a>
<a class="sourceLine" id="cb1-112" title="112"><span class="fu">geometry:area({</span><span class="ch">rectangle</span><span class="fu">,</span> <span class="dv">10</span><span class="fu">,</span> <span class="dv">5</span><span class="fu">}).</span>  <span class="co">% 50</span></a>
<a class="sourceLine" id="cb1-113" title="113"><span class="fu">geometry:area({</span><span class="ch">circle</span><span class="fu">,</span> <span class="fl">1.4</span><span class="fu">}).</span>  <span class="co">% 6.15752</span></a>
<a class="sourceLine" id="cb1-114" title="114"></a>
<a class="sourceLine" id="cb1-115" title="115"><span class="co">% In Erlang, two functions with the same name and different arity (number of</span></a>
<a class="sourceLine" id="cb1-116" title="116"><span class="co">% arguments) in the same module represent entirely different functions.</span></a>
<a class="sourceLine" id="cb1-117" title="117"><span class="kw">-module</span><span class="fu">(</span><span class="ch">lib_misc</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-118" title="118"><span class="kw">-export</span><span class="fu">([</span><span class="ch">sum</span><span class="op">/</span><span class="dv">1</span><span class="fu">]).</span> <span class="co">% export function `sum` of arity 1</span></a>
<a class="sourceLine" id="cb1-119" title="119">                  <span class="co">% accepting one argument: list of integers.</span></a>
<a class="sourceLine" id="cb1-120" title="120"><span class="fu">sum(</span><span class="va">L</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">sum(</span><span class="va">L</span><span class="fu">,</span> <span class="dv">0</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-121" title="121"><span class="fu">sum([],</span> <span class="va">N</span><span class="fu">)</span>    <span class="op">-&gt;</span> <span class="va">N</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-122" title="122"><span class="fu">sum([</span><span class="va">H</span><span class="fu">|</span><span class="va">T</span><span class="fu">],</span> <span class="va">N</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">sum(</span><span class="va">T</span><span class="fu">,</span> <span class="va">H</span><span class="op">+</span><span class="va">N</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-123" title="123"></a>
<a class="sourceLine" id="cb1-124" title="124"><span class="co">% Funs are &quot;anonymous&quot; functions. They are called this way because they have</span></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="co">% no name. However, they can be assigned to variables.</span></a>
<a class="sourceLine" id="cb1-126" title="126"><span class="va">Double</span> <span class="op">=</span> <span class="kw">fun</span><span class="fu">(</span><span class="va">X</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="dv">2</span> <span class="op">*</span> <span class="va">X</span> <span class="kw">end</span><span class="fu">.</span> <span class="co">% `Double` points to an anonymous function</span></a>
<a class="sourceLine" id="cb1-127" title="127">                              <span class="co">% with handle: #Fun&lt;erl_eval.6.17052888&gt;</span></a>
<a class="sourceLine" id="cb1-128" title="128"><span class="va">Double</span><span class="fu">(</span><span class="dv">2</span><span class="fu">).</span>  <span class="co">% 4</span></a>
<a class="sourceLine" id="cb1-129" title="129"></a>
<a class="sourceLine" id="cb1-130" title="130"><span class="co">% Functions accept funs as their arguments and can return funs.</span></a>
<a class="sourceLine" id="cb1-131" title="131"><span class="va">Mult</span> <span class="op">=</span> <span class="kw">fun</span><span class="fu">(</span><span class="va">Times</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">(</span> <span class="kw">fun</span><span class="fu">(</span><span class="va">X</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">X</span> <span class="op">*</span> <span class="va">Times</span> <span class="kw">end</span> <span class="fu">)</span> <span class="kw">end</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-132" title="132"><span class="va">Triple</span> <span class="op">=</span> <span class="va">Mult</span><span class="fu">(</span><span class="dv">3</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-133" title="133"><span class="va">Triple</span><span class="fu">(</span><span class="dv">5</span><span class="fu">).</span>  <span class="co">% 15</span></a>
<a class="sourceLine" id="cb1-134" title="134"></a>
<a class="sourceLine" id="cb1-135" title="135"><span class="co">% List comprehensions are expressions that create lists without having to use</span></a>
<a class="sourceLine" id="cb1-136" title="136"><span class="co">% funs, maps, or filters.</span></a>
<a class="sourceLine" id="cb1-137" title="137"><span class="co">% The notation `[F(X) || X &lt;- L]` means &quot;the list of `F(X)` where `X` is taken</span></a>
<a class="sourceLine" id="cb1-138" title="138"><span class="co">% from the list `L`.&quot;</span></a>
<a class="sourceLine" id="cb1-139" title="139"><span class="va">L</span> <span class="op">=</span> <span class="fu">[</span><span class="dv">1</span><span class="fu">,</span><span class="dv">2</span><span class="fu">,</span><span class="dv">3</span><span class="fu">,</span><span class="dv">4</span><span class="fu">,</span><span class="dv">5</span><span class="fu">].</span></a>
<a class="sourceLine" id="cb1-140" title="140"><span class="fu">[</span><span class="dv">2</span> <span class="op">*</span> <span class="va">X</span> <span class="fu">||</span> <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">L</span><span class="fu">].</span>  <span class="co">% [2,4,6,8,10]</span></a>
<a class="sourceLine" id="cb1-141" title="141"><span class="co">% A list comprehension can have generators and filters, which select subset of</span></a>
<a class="sourceLine" id="cb1-142" title="142"><span class="co">% the generated values.</span></a>
<a class="sourceLine" id="cb1-143" title="143"><span class="va">EvenNumbers</span> <span class="op">=</span> <span class="fu">[</span><span class="va">N</span> <span class="fu">||</span> <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu">[</span><span class="dv">1</span><span class="fu">,</span> <span class="dv">2</span><span class="fu">,</span> <span class="dv">3</span><span class="fu">,</span> <span class="dv">4</span><span class="fu">],</span> <span class="va">N</span> <span class="op">rem</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="fu">].</span> <span class="co">% [2, 4]</span></a>
<a class="sourceLine" id="cb1-144" title="144"></a>
<a class="sourceLine" id="cb1-145" title="145"><span class="co">% Guards are constructs that we can use to increase the power of pattern</span></a>
<a class="sourceLine" id="cb1-146" title="146"><span class="co">% matching. Using guards, we can perform simple tests and comparisons on the</span></a>
<a class="sourceLine" id="cb1-147" title="147"><span class="co">% variables in a pattern.</span></a>
<a class="sourceLine" id="cb1-148" title="148"><span class="co">% You can use guards in the heads of function definitions where they are</span></a>
<a class="sourceLine" id="cb1-149" title="149"><span class="co">% introduced by the `when` keyword, or you can use them at any place in the</span></a>
<a class="sourceLine" id="cb1-150" title="150"><span class="co">% language where an expression is allowed.</span></a>
<a class="sourceLine" id="cb1-151" title="151"><span class="fu">max(</span><span class="va">X</span><span class="fu">,</span> <span class="va">Y</span><span class="fu">)</span> <span class="ch">when</span> <span class="va">X</span> <span class="op">&gt;</span> <span class="va">Y</span> <span class="op">-&gt;</span> <span class="va">X</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-152" title="152"><span class="fu">max(</span><span class="va">X</span><span class="fu">,</span> <span class="va">Y</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">Y</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-153" title="153"></a>
<a class="sourceLine" id="cb1-154" title="154"><span class="co">% A guard is a series of guard expressions, separated by commas (`,`).</span></a>
<a class="sourceLine" id="cb1-155" title="155"><span class="co">% The guard `GuardExpr1, GuardExpr2, ..., GuardExprN` is true if all the guard</span></a>
<a class="sourceLine" id="cb1-156" title="156"><span class="co">% expressions `GuardExpr1`, `GuardExpr2`, ..., `GuardExprN` evaluate to `true`.</span></a>
<a class="sourceLine" id="cb1-157" title="157"><span class="fu">is_cat(</span><span class="va">A</span><span class="fu">)</span> <span class="ch">when</span> <span class="fu">is_atom(</span><span class="va">A</span><span class="fu">),</span> <span class="va">A</span> <span class="op">=:=</span> <span class="ch">cat</span> <span class="op">-&gt;</span> <span class="ch">true</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-158" title="158"><span class="fu">is_cat(</span><span class="va">A</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="ch">false</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-159" title="159"><span class="fu">is_dog(</span><span class="va">A</span><span class="fu">)</span> <span class="ch">when</span> <span class="fu">is_atom(</span><span class="va">A</span><span class="fu">),</span> <span class="va">A</span> <span class="op">=:=</span> <span class="ch">dog</span> <span class="op">-&gt;</span> <span class="ch">true</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-160" title="160"><span class="fu">is_dog(</span><span class="va">A</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="ch">false</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-161" title="161"></a>
<a class="sourceLine" id="cb1-162" title="162"><span class="co">% We won&#39;t dwell on the `=:=` operator here; just be aware that it is used to</span></a>
<a class="sourceLine" id="cb1-163" title="163"><span class="co">% check whether two Erlang expressions have the same value *and* the same type.</span></a>
<a class="sourceLine" id="cb1-164" title="164"><span class="co">% Contrast this behaviour to that of the `==` operator:</span></a>
<a class="sourceLine" id="cb1-165" title="165"><span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">=:=</span> <span class="dv">3</span><span class="fu">.</span>   <span class="co">% true</span></a>
<a class="sourceLine" id="cb1-166" title="166"><span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">=:=</span> <span class="fl">3.0</span><span class="fu">.</span> <span class="co">% false</span></a>
<a class="sourceLine" id="cb1-167" title="167"><span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">==</span>  <span class="fl">3.0</span><span class="fu">.</span> <span class="co">% true</span></a>
<a class="sourceLine" id="cb1-168" title="168"></a>
<a class="sourceLine" id="cb1-169" title="169"><span class="co">% A guard sequence is either a single guard or a series of guards, separated</span></a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">% by semicolons (`;`). The guard sequence `G1; G2; ...; Gn` is true if at</span></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="co">% least one of the guards `G1`, `G2`, ..., `Gn` evaluates to `true`.</span></a>
<a class="sourceLine" id="cb1-172" title="172"><span class="fu">is_pet(</span><span class="va">A</span><span class="fu">)</span> <span class="ch">when</span> <span class="fu">is_atom(</span><span class="va">A</span><span class="fu">),</span> <span class="fu">(</span><span class="va">A</span> <span class="op">=:=</span> <span class="ch">dog</span><span class="fu">);(</span><span class="va">A</span> <span class="op">=:=</span> <span class="ch">cat</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="ch">true</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-173" title="173"><span class="fu">is_pet(</span><span class="va">A</span><span class="fu">)</span>                                             <span class="op">-&gt;</span> <span class="ch">false</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-174" title="174"></a>
<a class="sourceLine" id="cb1-175" title="175"><span class="co">% Warning: not all valid Erlang expressions can be used as guard expressions;</span></a>
<a class="sourceLine" id="cb1-176" title="176"><span class="co">% in particular, our `is_cat` and `is_dog` functions cannot be used within the</span></a>
<a class="sourceLine" id="cb1-177" title="177"><span class="co">% guard sequence in `is_pet`&#39;s definition. For a description of the</span></a>
<a class="sourceLine" id="cb1-178" title="178"><span class="co">% expressions allowed in guard sequences, refer to the specific section</span></a>
<a class="sourceLine" id="cb1-179" title="179"><span class="co">% in the Erlang reference manual:</span></a>
<a class="sourceLine" id="cb1-180" title="180"><span class="co">% http://erlang.org/doc/reference_manual/expressions.html#guards</span></a>
<a class="sourceLine" id="cb1-181" title="181"></a>
<a class="sourceLine" id="cb1-182" title="182"></a>
<a class="sourceLine" id="cb1-183" title="183"><span class="co">% Records provide a method for associating a name with a particular element in a</span></a>
<a class="sourceLine" id="cb1-184" title="184"><span class="co">% tuple.</span></a>
<a class="sourceLine" id="cb1-185" title="185"><span class="co">% Record definitions can be included in Erlang source code files or put in files</span></a>
<a class="sourceLine" id="cb1-186" title="186"><span class="co">% with the extension `.hrl`, which are then included by Erlang source code</span></a>
<a class="sourceLine" id="cb1-187" title="187"><span class="co">% files.</span></a>
<a class="sourceLine" id="cb1-188" title="188"><span class="op">-</span><span class="fu">record(</span><span class="ch">todo</span><span class="fu">,</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-189" title="189">  <span class="ch">status</span> <span class="op">=</span> <span class="ch">reminder</span><span class="fu">,</span>  <span class="co">% Default value</span></a>
<a class="sourceLine" id="cb1-190" title="190">  <span class="ch">who</span> <span class="op">=</span> <span class="ch">joe</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-191" title="191">  <span class="ch">text</span></a>
<a class="sourceLine" id="cb1-192" title="192"><span class="fu">}).</span></a>
<a class="sourceLine" id="cb1-193" title="193"></a>
<a class="sourceLine" id="cb1-194" title="194"><span class="co">% We have to read the record definitions into the shell before we can define a</span></a>
<a class="sourceLine" id="cb1-195" title="195"><span class="co">% record. We use the shell function `rr` (short for read records) to do this.</span></a>
<a class="sourceLine" id="cb1-196" title="196"><span class="fu">rr(</span><span class="st">&quot;records.hrl&quot;</span><span class="fu">).</span>  <span class="co">% [todo]</span></a>
<a class="sourceLine" id="cb1-197" title="197"></a>
<a class="sourceLine" id="cb1-198" title="198"><span class="co">% Creating and updating records:</span></a>
<a class="sourceLine" id="cb1-199" title="199"><span class="va">X</span> <span class="op">=</span> <span class="fu">#</span><span class="ch">todo</span><span class="fu">{}.</span></a>
<a class="sourceLine" id="cb1-200" title="200"><span class="co">% #todo{status = reminder, who = joe, text = undefined}</span></a>
<a class="sourceLine" id="cb1-201" title="201"><span class="va">X1</span> <span class="op">=</span> <span class="fu">#</span><span class="ch">todo</span><span class="fu">{</span><span class="ch">status</span> <span class="op">=</span> <span class="ch">urgent</span><span class="fu">,</span> <span class="ch">text</span> <span class="op">=</span> <span class="st">&quot;Fix errata in book&quot;</span><span class="fu">}.</span></a>
<a class="sourceLine" id="cb1-202" title="202"><span class="co">% #todo{status = urgent, who = joe, text = &quot;Fix errata in book&quot;}</span></a>
<a class="sourceLine" id="cb1-203" title="203"><span class="va">X2</span> <span class="op">=</span> <span class="va">X1</span><span class="fu">#</span><span class="ch">todo</span><span class="fu">{</span><span class="ch">status</span> <span class="op">=</span> <span class="ch">done</span><span class="fu">}.</span></a>
<a class="sourceLine" id="cb1-204" title="204"><span class="co">% #todo{status = done, who = joe, text = &quot;Fix errata in book&quot;}</span></a>
<a class="sourceLine" id="cb1-205" title="205"></a>
<a class="sourceLine" id="cb1-206" title="206"><span class="co">% `case` expressions.</span></a>
<a class="sourceLine" id="cb1-207" title="207"><span class="co">% `filter` returns a list of all elements `X` in a list `L` for which `P(X)` is</span></a>
<a class="sourceLine" id="cb1-208" title="208"><span class="co">% true.</span></a>
<a class="sourceLine" id="cb1-209" title="209"><span class="fu">filter(</span><span class="va">P</span><span class="fu">,</span> <span class="fu">[</span><span class="va">H</span><span class="fu">|</span><span class="va">T</span><span class="fu">])</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-210" title="210">  <span class="kw">case</span> <span class="va">P</span><span class="fu">(</span><span class="va">H</span><span class="fu">)</span> <span class="kw">of</span></a>
<a class="sourceLine" id="cb1-211" title="211">    <span class="ch">true</span> <span class="op">-&gt;</span> <span class="fu">[</span><span class="va">H</span><span class="fu">|filter(</span><span class="va">P</span><span class="fu">,</span> <span class="va">T</span><span class="fu">)];</span></a>
<a class="sourceLine" id="cb1-212" title="212">    <span class="ch">false</span> <span class="op">-&gt;</span> <span class="fu">filter(</span><span class="va">P</span><span class="fu">,</span> <span class="va">T</span><span class="fu">)</span></a>
<a class="sourceLine" id="cb1-213" title="213">  <span class="kw">end</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-214" title="214"><span class="fu">filter(</span><span class="va">P</span><span class="fu">,</span> <span class="fu">[])</span> <span class="op">-&gt;</span> <span class="fu">[].</span></a>
<a class="sourceLine" id="cb1-215" title="215"><span class="fu">filter(</span><span class="kw">fun</span><span class="fu">(</span><span class="va">X</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="va">X</span> <span class="op">rem</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="kw">end</span><span class="fu">,</span> <span class="fu">[</span><span class="dv">1</span><span class="fu">,</span> <span class="dv">2</span><span class="fu">,</span> <span class="dv">3</span><span class="fu">,</span> <span class="dv">4</span><span class="fu">]).</span> <span class="co">% [2, 4]</span></a>
<a class="sourceLine" id="cb1-216" title="216"></a>
<a class="sourceLine" id="cb1-217" title="217"><span class="co">% `if` expressions.</span></a>
<a class="sourceLine" id="cb1-218" title="218"><span class="fu">max(</span><span class="va">X</span><span class="fu">,</span> <span class="va">Y</span><span class="fu">)</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-219" title="219">  <span class="kw">if</span></a>
<a class="sourceLine" id="cb1-220" title="220">    <span class="va">X</span> <span class="op">&gt;</span> <span class="va">Y</span> <span class="op">-&gt;</span> <span class="va">X</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-221" title="221">    <span class="va">X</span> <span class="op">&lt;</span> <span class="va">Y</span> <span class="op">-&gt;</span> <span class="va">Y</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-222" title="222">    <span class="ch">true</span> <span class="op">-&gt;</span> <span class="ch">nil</span></a>
<a class="sourceLine" id="cb1-223" title="223">  <span class="kw">end</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-224" title="224"></a>
<a class="sourceLine" id="cb1-225" title="225"><span class="co">% Warning: at least one of the guards in the `if` expression must evaluate to</span></a>
<a class="sourceLine" id="cb1-226" title="226"><span class="co">% `true`; otherwise, an exception will be raised.</span></a>
<a class="sourceLine" id="cb1-227" title="227"></a>
<a class="sourceLine" id="cb1-228" title="228"></a>
<a class="sourceLine" id="cb1-229" title="229"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-230" title="230"><span class="co">%% 3. Exceptions.</span></a>
<a class="sourceLine" id="cb1-231" title="231"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-232" title="232"></a>
<a class="sourceLine" id="cb1-233" title="233"><span class="co">% Exceptions are raised by the system when internal errors are encountered or</span></a>
<a class="sourceLine" id="cb1-234" title="234"><span class="co">% explicitly in code by calling `throw(Exception)`, `exit(Exception)`, or</span></a>
<a class="sourceLine" id="cb1-235" title="235"><span class="co">% `erlang:error(Exception)`.</span></a>
<a class="sourceLine" id="cb1-236" title="236"><span class="fu">generate_exception(</span><span class="dv">1</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="ch">a</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-237" title="237"><span class="fu">generate_exception(</span><span class="dv">2</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">throw(</span><span class="ch">a</span><span class="fu">);</span></a>
<a class="sourceLine" id="cb1-238" title="238"><span class="fu">generate_exception(</span><span class="dv">3</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">exit(</span><span class="ch">a</span><span class="fu">);</span></a>
<a class="sourceLine" id="cb1-239" title="239"><span class="fu">generate_exception(</span><span class="dv">4</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">{</span><span class="ch">&#39;EXIT&#39;</span><span class="fu">,</span> <span class="ch">a</span><span class="fu">};</span></a>
<a class="sourceLine" id="cb1-240" title="240"><span class="fu">generate_exception(</span><span class="dv">5</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="fu">erlang:error(</span><span class="ch">a</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-241" title="241"></a>
<a class="sourceLine" id="cb1-242" title="242"><span class="co">% Erlang has two methods of catching an exception. One is to enclose the call to</span></a>
<a class="sourceLine" id="cb1-243" title="243"><span class="co">% the function that raises the exception within a `try...catch` expression.</span></a>
<a class="sourceLine" id="cb1-244" title="244"><span class="fu">catcher(</span><span class="va">N</span><span class="fu">)</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-245" title="245">  <span class="ch">try</span> <span class="fu">generate_exception(</span><span class="va">N</span><span class="fu">)</span> <span class="kw">of</span></a>
<a class="sourceLine" id="cb1-246" title="246">    <span class="va">Val</span> <span class="op">-&gt;</span> <span class="fu">{</span><span class="va">N</span><span class="fu">,</span> <span class="ch">normal</span><span class="fu">,</span> <span class="va">Val</span><span class="fu">}</span></a>
<a class="sourceLine" id="cb1-247" title="247">  <span class="kw">catch</span></a>
<a class="sourceLine" id="cb1-248" title="248">    <span class="fu">throw:</span><span class="va">X</span> <span class="op">-&gt;</span> <span class="fu">{</span><span class="va">N</span><span class="fu">,</span> <span class="ch">caught</span><span class="fu">,</span> <span class="ch">thrown</span><span class="fu">,</span> <span class="va">X</span><span class="fu">};</span></a>
<a class="sourceLine" id="cb1-249" title="249">    <span class="fu">exit:</span><span class="va">X</span> <span class="op">-&gt;</span> <span class="fu">{</span><span class="va">N</span><span class="fu">,</span> <span class="ch">caught</span><span class="fu">,</span> <span class="ch">exited</span><span class="fu">,</span> <span class="va">X</span><span class="fu">};</span></a>
<a class="sourceLine" id="cb1-250" title="250">    <span class="ch">error</span><span class="fu">:</span><span class="va">X</span> <span class="op">-&gt;</span> <span class="fu">{</span><span class="va">N</span><span class="fu">,</span> <span class="ch">caught</span><span class="fu">,</span> <span class="ch">error</span><span class="fu">,</span> <span class="va">X</span><span class="fu">}</span></a>
<a class="sourceLine" id="cb1-251" title="251">  <span class="kw">end</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-252" title="252"></a>
<a class="sourceLine" id="cb1-253" title="253"><span class="co">% The other is to enclose the call in a `catch` expression. When you catch an</span></a>
<a class="sourceLine" id="cb1-254" title="254"><span class="co">% exception, it is converted into a tuple that describes the error.</span></a>
<a class="sourceLine" id="cb1-255" title="255"><span class="fu">catcher(</span><span class="va">N</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="kw">catch</span> <span class="fu">generate_exception(</span><span class="va">N</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-256" title="256"></a>
<a class="sourceLine" id="cb1-257" title="257"></a>
<a class="sourceLine" id="cb1-258" title="258"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-259" title="259"><span class="co">%% 4. Concurrency</span></a>
<a class="sourceLine" id="cb1-260" title="260"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-261" title="261"></a>
<a class="sourceLine" id="cb1-262" title="262"><span class="co">% Erlang relies on the actor model for concurrency. All we need to write</span></a>
<a class="sourceLine" id="cb1-263" title="263"><span class="co">% concurrent programs in Erlang are three primitives: spawning processes,</span></a>
<a class="sourceLine" id="cb1-264" title="264"><span class="co">% sending messages and receiving messages.</span></a>
<a class="sourceLine" id="cb1-265" title="265"></a>
<a class="sourceLine" id="cb1-266" title="266"><span class="co">% To start a new process, we use the `spawn` function, which takes a function</span></a>
<a class="sourceLine" id="cb1-267" title="267"><span class="co">% as argument.</span></a>
<a class="sourceLine" id="cb1-268" title="268"></a>
<a class="sourceLine" id="cb1-269" title="269"><span class="va">F</span> <span class="op">=</span> <span class="kw">fun</span><span class="fu">()</span> <span class="op">-&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span> <span class="kw">end</span><span class="fu">.</span> <span class="co">% #Fun&lt;erl_eval.20.67289768&gt;</span></a>
<a class="sourceLine" id="cb1-270" title="270"><span class="fu">spawn(</span><span class="va">F</span><span class="fu">).</span> <span class="co">% &lt;0.44.0&gt;</span></a>
<a class="sourceLine" id="cb1-271" title="271"></a>
<a class="sourceLine" id="cb1-272" title="272"><span class="co">% `spawn` returns a pid (process identifier); you can use this pid to send</span></a>
<a class="sourceLine" id="cb1-273" title="273"><span class="co">% messages to the process. To do message passing, we use the `!` operator.</span></a>
<a class="sourceLine" id="cb1-274" title="274"><span class="co">% For all of this to be useful, we need to be able to receive messages. This is</span></a>
<a class="sourceLine" id="cb1-275" title="275"><span class="co">% achieved with the `receive` mechanism:</span></a>
<a class="sourceLine" id="cb1-276" title="276"></a>
<a class="sourceLine" id="cb1-277" title="277"><span class="kw">-module</span><span class="fu">(</span><span class="ch">calculateGeometry</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-278" title="278"><span class="op">-</span><span class="fu">compile(</span><span class="ch">export_all</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-279" title="279"><span class="fu">calculateArea()</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-280" title="280">    <span class="kw">receive</span></a>
<a class="sourceLine" id="cb1-281" title="281">      <span class="fu">{</span><span class="ch">rectangle</span><span class="fu">,</span> <span class="va">W</span><span class="fu">,</span> <span class="va">H</span><span class="fu">}</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-282" title="282">        <span class="va">W</span> <span class="op">*</span> <span class="va">H</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-283" title="283">      <span class="fu">{</span><span class="ch">circle</span><span class="fu">,</span> <span class="va">R</span><span class="fu">}</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-284" title="284">        <span class="fl">3.14</span> <span class="op">*</span> <span class="va">R</span> <span class="op">*</span> <span class="va">R</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-285" title="285">      <span class="va">_</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-286" title="286">        <span class="fu">io:format(</span><span class="st">&quot;We can only calculate area of rectangles or circles.&quot;</span><span class="fu">)</span></a>
<a class="sourceLine" id="cb1-287" title="287">    <span class="kw">end</span><span class="fu">.</span></a>
<a class="sourceLine" id="cb1-288" title="288"></a>
<a class="sourceLine" id="cb1-289" title="289"><span class="co">% Compile the module and create a process that evaluates `calculateArea` in the</span></a>
<a class="sourceLine" id="cb1-290" title="290"><span class="co">% shell.</span></a>
<a class="sourceLine" id="cb1-291" title="291"><span class="fu">c(</span><span class="ch">calculateGeometry</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-292" title="292"><span class="va">CalculateArea</span> <span class="op">=</span> <span class="fu">spawn(</span><span class="ch">calculateGeometry</span><span class="fu">,</span> <span class="ch">calculateArea</span><span class="fu">,</span> <span class="fu">[]).</span></a>
<a class="sourceLine" id="cb1-293" title="293"><span class="va">CalculateArea</span> <span class="op">!</span> <span class="fu">{</span><span class="ch">circle</span><span class="fu">,</span> <span class="dv">2</span><span class="fu">}.</span> <span class="co">% 12.56000000000000049738</span></a>
<a class="sourceLine" id="cb1-294" title="294"></a>
<a class="sourceLine" id="cb1-295" title="295"><span class="co">% The shell is also a process; you can use `self` to get the current pid.</span></a>
<a class="sourceLine" id="cb1-296" title="296"><span class="fu">self().</span> <span class="co">% &lt;0.41.0&gt;</span></a>
<a class="sourceLine" id="cb1-297" title="297"></a>
<a class="sourceLine" id="cb1-298" title="298"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-299" title="299"><span class="co">%% 5. Testing with EUnit</span></a>
<a class="sourceLine" id="cb1-300" title="300"><span class="co">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></a>
<a class="sourceLine" id="cb1-301" title="301"></a>
<a class="sourceLine" id="cb1-302" title="302"><span class="co">% Unit tests can be written using EUnits&#39;s test generators and assert macros</span></a>
<a class="sourceLine" id="cb1-303" title="303"><span class="kw">-module</span><span class="fu">(</span><span class="ch">fib</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-304" title="304"><span class="kw">-export</span><span class="fu">([</span><span class="ch">fib</span><span class="op">/</span><span class="dv">1</span><span class="fu">]).</span></a>
<a class="sourceLine" id="cb1-305" title="305"><span class="kw">-include</span><span class="va">_lib</span><span class="fu">(</span><span class="st">&quot;eunit/include/eunit.hrl&quot;</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-306" title="306"></a>
<a class="sourceLine" id="cb1-307" title="307"><span class="fu">fib(</span><span class="dv">0</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="dv">1</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-308" title="308"><span class="fu">fib(</span><span class="dv">1</span><span class="fu">)</span> <span class="op">-&gt;</span> <span class="dv">1</span><span class="fu">;</span></a>
<a class="sourceLine" id="cb1-309" title="309"><span class="fu">fib(</span><span class="va">N</span><span class="fu">)</span> <span class="ch">when</span> <span class="va">N</span> <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">-&gt;</span> <span class="fu">fib(</span><span class="va">N</span><span class="op">-</span><span class="dv">1</span><span class="fu">)</span> <span class="op">+</span> <span class="fu">fib(</span><span class="va">N</span><span class="op">-</span><span class="dv">2</span><span class="fu">).</span></a>
<a class="sourceLine" id="cb1-310" title="310"></a>
<a class="sourceLine" id="cb1-311" title="311"><span class="fu">fib_test_()</span> <span class="op">-&gt;</span></a>
<a class="sourceLine" id="cb1-312" title="312">    <span class="fu">[?</span>_<span class="fu">assert(fib(</span><span class="dv">0</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">1</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-313" title="313">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">1</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">1</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-314" title="314">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">2</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">2</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-315" title="315">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">3</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">3</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-316" title="316">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">4</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">5</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-317" title="317">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">5</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">8</span><span class="fu">),</span></a>
<a class="sourceLine" id="cb1-318" title="318">     <span class="fu">?</span>_<span class="fu">assertException(</span><span class="ch">error</span><span class="fu">,</span> <span class="ch">function_clause</span><span class="fu">,</span> <span class="fu">fib(</span><span class="op">-</span><span class="dv">1</span><span class="fu">)),</span></a>
<a class="sourceLine" id="cb1-319" title="319">     <span class="fu">?</span>_<span class="fu">assert(fib(</span><span class="dv">31</span><span class="fu">)</span> <span class="op">=:=</span> <span class="dv">2178309</span><span class="fu">)</span></a>
<a class="sourceLine" id="cb1-320" title="320">    <span class="fu">].</span></a>
<a class="sourceLine" id="cb1-321" title="321"></a>
<a class="sourceLine" id="cb1-322" title="322"><span class="co">% EUnit will automatically export to a test() function to allow running the tests</span></a>
<a class="sourceLine" id="cb1-323" title="323"><span class="co">% in the erlang shell</span></a>
<a class="sourceLine" id="cb1-324" title="324"><span class="fu">fib:test()</span></a>
<a class="sourceLine" id="cb1-325" title="325"></a>
<a class="sourceLine" id="cb1-326" title="326"><span class="co">% The popular erlang build tool Rebar is also compatible with EUnit</span></a>
<a class="sourceLine" id="cb1-327" title="327"><span class="co">% ```</span></a>
<a class="sourceLine" id="cb1-328" title="328"><span class="co">% rebar eunit</span></a>
<a class="sourceLine" id="cb1-329" title="329"><span class="co">% ```</span></a></code></pre></div>
<h2 id="references">References</h2>
<ul>
<li><a href="http://learnyousomeerlang.com/">“Learn You Some Erlang for great good!”</a></li>
<li><a href="http://pragprog.com/book/jaerlang/programming-erlang">“Programming Erlang: Software for a Concurrent World” by Joe Armstrong</a></li>
<li><a href="http://www.erlang.org/doc/">Erlang/OTP Reference Documentation</a></li>
<li><a href="http://www.erlang.se/doc/programming_rules.shtml">Erlang - Programming Rules and Conventions</a></li>
</ul>
</body>
</html>
