<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>powershell.html</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<p>PowerShell is the Windows scripting language and configuration management framework from Microsoft built on the .NET Framework. Windows 7 and up ship with PowerShell.<br />
Nearly all examples below can be a part of a shell script or executed directly in the shell.</p>
<p>A key difference with Bash is that it is mostly objects that you manipulate rather than plain text. After years of evolving, it resembles Python a bit.</p>
<p><a href="https://docs.microsoft.com/powershell/scripting/overview">Read more here.</a></p>
<p>Powershell as a Language:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode powershell"><code class="sourceCode powershell"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># Single line comments start with a number symbol.</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">  Multi-line comments</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">  like so</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">## 1. Primitive Datatypes and Operators</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co"># Numbers</span></a>
<a class="sourceLine" id="cb1-15" title="15">3 <span class="co"># =&gt; 3</span></a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co"># Math</span></a>
<a class="sourceLine" id="cb1-18" title="18">1 + 1   <span class="co"># =&gt; 2</span></a>
<a class="sourceLine" id="cb1-19" title="19">8 - 1   <span class="co"># =&gt; 7</span></a>
<a class="sourceLine" id="cb1-20" title="20">10 * 2  <span class="co"># =&gt; 20</span></a>
<a class="sourceLine" id="cb1-21" title="21">35 / 5  <span class="co"># =&gt; 7.0</span></a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co"># Powershell uses banker&#39;s rounding,</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co"># meaning [int]1.5 would round to 2 but so would [int]2.5</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co"># Division always returns a float. </span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co"># You must cast result to [int] to round.</span></a>
<a class="sourceLine" id="cb1-27" title="27">[<span class="dt">int</span>]5 / [<span class="dt">int</span>]3       <span class="co"># =&gt; 1.66666666666667</span></a>
<a class="sourceLine" id="cb1-28" title="28">[<span class="dt">int</span>]-5 / [<span class="dt">int</span>]3      <span class="co"># =&gt; -1.66666666666667</span></a>
<a class="sourceLine" id="cb1-29" title="29">5.<span class="fu">0</span> / 3.<span class="fu">0</span>   <span class="co"># =&gt; 1.66666666666667</span></a>
<a class="sourceLine" id="cb1-30" title="30">-5.<span class="fu">0</span> / 3.<span class="fu">0</span>  <span class="co"># =&gt; -1.66666666666667</span></a>
<a class="sourceLine" id="cb1-31" title="31">[<span class="dt">int</span>]<span class="va">$result</span> = 5 / 3 </a>
<a class="sourceLine" id="cb1-32" title="32"><span class="va">$result</span> <span class="co"># =&gt; 2</span></a>
<a class="sourceLine" id="cb1-33" title="33"></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co"># Modulo operation</span></a>
<a class="sourceLine" id="cb1-35" title="35">7 % 3  <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb1-36" title="36"></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co"># Exponentiation requires longform or the built-in [Math] class.</span></a>
<a class="sourceLine" id="cb1-38" title="38">[Math]::Pow(2,3)  <span class="co"># =&gt; 8</span></a>
<a class="sourceLine" id="cb1-39" title="39"></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co"># Enforce order of operations with parentheses.</span></a>
<a class="sourceLine" id="cb1-41" title="41">1 + 3 * 2  <span class="co"># =&gt; 7</span></a>
<a class="sourceLine" id="cb1-42" title="42">(1 + 3) * 2  <span class="co"># =&gt; 8</span></a>
<a class="sourceLine" id="cb1-43" title="43"></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co"># Boolean values are primitives (Note: the $)</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="va">$True</span>  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="va">$False</span>  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-47" title="47"></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co"># negate with !</span></a>
<a class="sourceLine" id="cb1-49" title="49">!<span class="va">$True</span>   <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-50" title="50">!<span class="va">$False</span>  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-51" title="51"></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="co"># Boolean Operators</span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="co"># Note &quot;-and&quot; and &quot;-or&quot; usage</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="va">$True</span> -and <span class="va">$False</span>  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="va">$False</span> -or <span class="va">$True</span>   <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-56" title="56"></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="co"># True and False are actually 1 and 0 but only support limited arithmetic.</span></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="co"># However, casting the bool to int resolves this.</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="va">$True</span> + <span class="va">$True</span> <span class="co"># =&gt; 2</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="va">$True</span> * 8    <span class="co"># =&gt; &#39;[System.Boolean] * [System.Int32]&#39; is undefined</span></a>
<a class="sourceLine" id="cb1-61" title="61">[<span class="dt">int</span>]<span class="va">$True</span> * 8 <span class="co"># =&gt; 8</span></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="va">$False</span> - 5   <span class="co"># =&gt; -5</span></a>
<a class="sourceLine" id="cb1-63" title="63"></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="co"># Comparison operators look at the numerical value of True and False.</span></a>
<a class="sourceLine" id="cb1-65" title="65">0 -eq <span class="va">$False</span>  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-66" title="66">1 -eq <span class="va">$True</span>   <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-67" title="67">2 -eq <span class="va">$True</span>   <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-68" title="68">-5 -ne <span class="va">$False</span> <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-69" title="69"></a>
<a class="sourceLine" id="cb1-70" title="70"><span class="co"># Using boolean logical operators on ints casts to booleans for evaluation.</span></a>
<a class="sourceLine" id="cb1-71" title="71"><span class="co"># but their non-cast value is returned</span></a>
<a class="sourceLine" id="cb1-72" title="72"><span class="co"># Don&#39;t mix up with bool(ints) and bitwise -band/-bor</span></a>
<a class="sourceLine" id="cb1-73" title="73">[<span class="dt">bool</span>](0)     <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-74" title="74">[<span class="dt">bool</span>](4)     <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-75" title="75">[<span class="dt">bool</span>](-6)    <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-76" title="76">0 -band 2     <span class="co"># =&gt; 0</span></a>
<a class="sourceLine" id="cb1-77" title="77">-5 -bor 0     <span class="co"># =&gt; -5</span></a>
<a class="sourceLine" id="cb1-78" title="78"></a>
<a class="sourceLine" id="cb1-79" title="79"><span class="co"># Equality is -eq (equals)</span></a>
<a class="sourceLine" id="cb1-80" title="80">1 -eq 1  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-81" title="81">2 -eq 1  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-82" title="82"></a>
<a class="sourceLine" id="cb1-83" title="83"><span class="co"># Inequality is -ne (notequals)</span></a>
<a class="sourceLine" id="cb1-84" title="84">1 -ne 1  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-85" title="85">2 -ne 1  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-86" title="86"></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="co"># More comparisons</span></a>
<a class="sourceLine" id="cb1-88" title="88">1 -lt 10  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-89" title="89">1 -gt 10  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-90" title="90">2 -le 2  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-91" title="91">2 -ge 2  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-92" title="92"></a>
<a class="sourceLine" id="cb1-93" title="93"><span class="co"># Seeing whether a value is in a range</span></a>
<a class="sourceLine" id="cb1-94" title="94">1 -lt 2 -and 2 -lt 3  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-95" title="95">2 -lt 3 -and 3 -lt 2  <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-96" title="96"></a>
<a class="sourceLine" id="cb1-97" title="97"><span class="co"># (-is vs. -eq) -is checks if two objects are the same type.</span></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="co"># -eq checks if the objects have the same values.</span></a>
<a class="sourceLine" id="cb1-99" title="99"><span class="co"># Note: we called &#39;[Math]&#39; from .NET previously without the preceeding</span></a>
<a class="sourceLine" id="cb1-100" title="100"><span class="co"># namespaces. We can do the same with [Collections.ArrayList] if preferred.</span></a>
<a class="sourceLine" id="cb1-101" title="101">[System.<span class="fu">Collections</span>.<span class="fu">ArrayList</span>]<span class="va">$a</span> = @()  <span class="co"># Point a at a new list</span></a>
<a class="sourceLine" id="cb1-102" title="102"><span class="va">$a</span> = (1,2,3,4)</a>
<a class="sourceLine" id="cb1-103" title="103"><span class="va">$b</span> = <span class="va">$a</span>                                 <span class="co"># =&gt; Point b at what a is pointing to</span></a>
<a class="sourceLine" id="cb1-104" title="104"><span class="va">$b</span> -is <span class="va">$a</span>.<span class="fu">GetType</span>()                     <span class="co"># =&gt; True, a and b equal same type</span></a>
<a class="sourceLine" id="cb1-105" title="105"><span class="va">$b</span> -eq <span class="va">$a</span>                               <span class="co"># =&gt; True, a and b values are equal</span></a>
<a class="sourceLine" id="cb1-106" title="106">[System.<span class="fu">Collections</span>.<span class="fu">Hashtable</span>]<span class="va">$b</span> = @{}  <span class="co"># =&gt; Point a at a new hash table</span></a>
<a class="sourceLine" id="cb1-107" title="107"><span class="va">$b</span> = @{&#39;one&#39; = 1 </a>
<a class="sourceLine" id="cb1-108" title="108">       &#39;two&#39; = 2}</a>
<a class="sourceLine" id="cb1-109" title="109"><span class="va">$b</span> -is <span class="va">$a</span>.<span class="fu">GetType</span>()                     <span class="co"># =&gt; False, a and b types not equal</span></a>
<a class="sourceLine" id="cb1-110" title="110"></a>
<a class="sourceLine" id="cb1-111" title="111"><span class="co"># Strings are created with &quot; or &#39; but &quot; is required for string interpolation</span></a>
<a class="sourceLine" id="cb1-112" title="112"><span class="st">&quot;This is a string.&quot;</span></a>
<a class="sourceLine" id="cb1-113" title="113">&#39;This is also a <span class="dt">string</span>.&#39;</a>
<a class="sourceLine" id="cb1-114" title="114"></a>
<a class="sourceLine" id="cb1-115" title="115"><span class="co"># Strings can be added too! But try not to do this.</span></a>
<a class="sourceLine" id="cb1-116" title="116"><span class="st">&quot;Hello &quot;</span> + <span class="st">&quot;world!&quot;</span>  <span class="co"># =&gt; &quot;Hello world!&quot;</span></a>
<a class="sourceLine" id="cb1-117" title="117"></a>
<a class="sourceLine" id="cb1-118" title="118"><span class="co"># A string can be treated like a list of characters</span></a>
<a class="sourceLine" id="cb1-119" title="119"><span class="st">&quot;Hello world!&quot;</span>[0]  <span class="co"># =&gt; &#39;H&#39;</span></a>
<a class="sourceLine" id="cb1-120" title="120"></a>
<a class="sourceLine" id="cb1-121" title="121"><span class="co"># You can find the length of a string</span></a>
<a class="sourceLine" id="cb1-122" title="122">(<span class="st">&quot;This is a string&quot;</span>).<span class="fu">Length</span>  <span class="co"># =&gt; 16</span></a>
<a class="sourceLine" id="cb1-123" title="123"></a>
<a class="sourceLine" id="cb1-124" title="124"><span class="co"># You can also format using f-strings or formatted string literals.</span></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="va">$name</span> = <span class="st">&quot;Steve&quot;</span></a>
<a class="sourceLine" id="cb1-126" title="126"><span class="va">$age</span> = 22</a>
<a class="sourceLine" id="cb1-127" title="127"><span class="st">&quot;He said his name is $name.&quot;</span> </a>
<a class="sourceLine" id="cb1-128" title="128"><span class="co"># =&gt; &quot;He said his name is Steve&quot;</span></a>
<a class="sourceLine" id="cb1-129" title="129"><span class="st">&quot;{0} said he is {1} years old.&quot;</span> -f <span class="va">$name</span>, <span class="va">$age</span> </a>
<a class="sourceLine" id="cb1-130" title="130"><span class="co"># =&gt; &quot;Steve said he is 22 years old&quot;</span></a>
<a class="sourceLine" id="cb1-131" title="131"><span class="st">&quot;$name&#39;s name is $($name.Length) characters long.&quot;</span> </a>
<a class="sourceLine" id="cb1-132" title="132"><span class="co"># =&gt; &quot;Steve&#39;s name is 5 characters long.&quot;</span></a>
<a class="sourceLine" id="cb1-133" title="133"></a>
<a class="sourceLine" id="cb1-134" title="134"><span class="co"># Escape Characters in Powershell</span></a>
<a class="sourceLine" id="cb1-135" title="135"><span class="co"># Many languages use the &#39;\&#39;, but Windows uses this character for </span></a>
<a class="sourceLine" id="cb1-136" title="136"><span class="co"># file paths. Powershell thus uses &#39;`&#39; to escape characters</span></a>
<a class="sourceLine" id="cb1-137" title="137"><span class="co"># Take caution when working with files, as &#39;`&#39; is a</span></a>
<a class="sourceLine" id="cb1-138" title="138"><span class="co"># valid character in NTFS filenames.</span></a>
<a class="sourceLine" id="cb1-139" title="139"><span class="st">&quot;Showing`nEscape Chars&quot;</span> <span class="co"># =&gt; new line between Showing and Escape</span></a>
<a class="sourceLine" id="cb1-140" title="140"><span class="st">&quot;Making`tTables`tWith`tTabs&quot;</span> <span class="co"># =&gt; Format things with tabs</span></a>
<a class="sourceLine" id="cb1-141" title="141"></a>
<a class="sourceLine" id="cb1-142" title="142"><span class="co"># Negate pound sign to prevent comment</span></a>
<a class="sourceLine" id="cb1-143" title="143"><span class="co"># Note that the function of &#39;#&#39; is removed, but &#39;#&#39; is still present</span></a>
<a class="sourceLine" id="cb1-144" title="144">`<span class="co">#Get-Process # =&gt; Fail: not a recognized cmdlet</span></a>
<a class="sourceLine" id="cb1-145" title="145"></a>
<a class="sourceLine" id="cb1-146" title="146"><span class="co"># $null is not an object</span></a>
<a class="sourceLine" id="cb1-147" title="147"><span class="va">$null</span>  <span class="co"># =&gt; None</span></a>
<a class="sourceLine" id="cb1-148" title="148"></a>
<a class="sourceLine" id="cb1-149" title="149"><span class="co"># $null, 0, and empty strings and arrays all evaluate to False.</span></a>
<a class="sourceLine" id="cb1-150" title="150"><span class="co"># All other values are True</span></a>
<a class="sourceLine" id="cb1-151" title="151"><span class="kw">function</span> Test-Value (<span class="va">$value</span>) {</a>
<a class="sourceLine" id="cb1-152" title="152">  <span class="kw">if</span> (<span class="va">$value</span>) {</a>
<a class="sourceLine" id="cb1-153" title="153">    <span class="fu">Write-Output</span> &#39;True&#39;</a>
<a class="sourceLine" id="cb1-154" title="154">  }</a>
<a class="sourceLine" id="cb1-155" title="155">  <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-156" title="156">    <span class="fu">Write-Output</span> &#39;False&#39;</a>
<a class="sourceLine" id="cb1-157" title="157">  }</a>
<a class="sourceLine" id="cb1-158" title="158">}</a>
<a class="sourceLine" id="cb1-159" title="159"></a>
<a class="sourceLine" id="cb1-160" title="160">Test-Value (<span class="va">$null</span>) <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-161" title="161">Test-Value (0)     <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-162" title="162">Test-Value (<span class="st">&quot;&quot;</span>)    <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-163" title="163">Test-Value []      <span class="co"># =&gt; True </span></a>
<a class="sourceLine" id="cb1-164" title="164"><span class="co"># *[] calls .NET class; creates &#39;[]&#39; string when passed to function</span></a>
<a class="sourceLine" id="cb1-165" title="165">Test-Value ({})    <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-166" title="166">Test-Value @()     <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-167" title="167"></a>
<a class="sourceLine" id="cb1-168" title="168"></a>
<a class="sourceLine" id="cb1-169" title="169"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">## 2. Variables and Collections</span></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-172" title="172"></a>
<a class="sourceLine" id="cb1-173" title="173"><span class="co"># Powershell uses the &quot;Write-Output&quot; function to print</span></a>
<a class="sourceLine" id="cb1-174" title="174"><span class="fu">Write-Output</span> <span class="st">&quot;I&#39;m Posh. Nice to meet you!&quot;</span>  <span class="co"># =&gt; I&#39;m Posh. Nice to meet you!</span></a>
<a class="sourceLine" id="cb1-175" title="175"></a>
<a class="sourceLine" id="cb1-176" title="176"><span class="co"># Simple way to get input data from console</span></a>
<a class="sourceLine" id="cb1-177" title="177"><span class="va">$userInput</span> = <span class="fu">Read-Host</span> <span class="st">&quot;Enter some data: &quot;</span> <span class="co"># Returns the data as a string</span></a>
<a class="sourceLine" id="cb1-178" title="178"></a>
<a class="sourceLine" id="cb1-179" title="179"><span class="co"># There are no declarations, only assignments.</span></a>
<a class="sourceLine" id="cb1-180" title="180"><span class="co"># Convention is to use camelCase or PascalCase, whatever your team uses.</span></a>
<a class="sourceLine" id="cb1-181" title="181"><span class="va">$someVariable</span> = 5</a>
<a class="sourceLine" id="cb1-182" title="182"><span class="va">$someVariable</span>  <span class="co"># =&gt; 5</span></a>
<a class="sourceLine" id="cb1-183" title="183"></a>
<a class="sourceLine" id="cb1-184" title="184"><span class="co"># Accessing a previously unassigned variable does not throw exception.</span></a>
<a class="sourceLine" id="cb1-185" title="185"><span class="co"># The value is $null by default</span></a>
<a class="sourceLine" id="cb1-186" title="186"></a>
<a class="sourceLine" id="cb1-187" title="187"><span class="co"># Ternary Operators exist in Powershell 7 and up</span></a>
<a class="sourceLine" id="cb1-188" title="188">0 ? &#39;yes&#39; : &#39;no&#39;  <span class="co"># =&gt; no</span></a>
<a class="sourceLine" id="cb1-189" title="189"></a>
<a class="sourceLine" id="cb1-190" title="190"></a>
<a class="sourceLine" id="cb1-191" title="191"><span class="co"># The default array object in Powershell is an fixed length array.</span></a>
<a class="sourceLine" id="cb1-192" title="192"><span class="va">$defaultArray</span> = <span class="st">&quot;thing&quot;</span>,<span class="st">&quot;thing2&quot;</span>,<span class="st">&quot;thing3&quot;</span></a>
<a class="sourceLine" id="cb1-193" title="193"><span class="co"># you can add objects with &#39;+=&#39;, but cannot remove objects.</span></a>
<a class="sourceLine" id="cb1-194" title="194"><span class="va">$defaultArray</span>.<span class="fu">Add</span>(<span class="st">&quot;thing4&quot;</span>) <span class="co"># =&gt; Exception &quot;Collection was of a fixed size.&quot;</span></a>
<a class="sourceLine" id="cb1-195" title="195"><span class="co"># To have a more workable array, you&#39;ll want the .NET [ArrayList] class</span></a>
<a class="sourceLine" id="cb1-196" title="196"><span class="co"># It is also worth noting that ArrayLists are significantly faster</span></a>
<a class="sourceLine" id="cb1-197" title="197"></a>
<a class="sourceLine" id="cb1-198" title="198"><span class="co"># ArrayLists store sequences</span></a>
<a class="sourceLine" id="cb1-199" title="199">[System.<span class="fu">Collections</span>.<span class="fu">ArrayList</span>]<span class="va">$array</span> = @()</a>
<a class="sourceLine" id="cb1-200" title="200"><span class="co"># You can start with a prefilled ArrayList</span></a>
<a class="sourceLine" id="cb1-201" title="201">[System.<span class="fu">Collections</span>.<span class="fu">ArrayList</span>]<span class="va">$otherArray</span> = @(4, 5, 6)</a>
<a class="sourceLine" id="cb1-202" title="202"></a>
<a class="sourceLine" id="cb1-203" title="203"><span class="co"># Add to the end of a list with &#39;Add&#39; (Note: produces output, append to $null)</span></a>
<a class="sourceLine" id="cb1-204" title="204"><span class="va">$array</span>.<span class="fu">Add</span>(1) &gt; <span class="va">$null</span>    <span class="co"># $array is now [1]</span></a>
<a class="sourceLine" id="cb1-205" title="205"><span class="va">$array</span>.<span class="fu">Add</span>(2) &gt; <span class="va">$null</span>    <span class="co"># $array is now [1, 2]</span></a>
<a class="sourceLine" id="cb1-206" title="206"><span class="va">$array</span>.<span class="fu">Add</span>(4) &gt; <span class="va">$null</span>    <span class="co"># $array is now [1, 2, 4]</span></a>
<a class="sourceLine" id="cb1-207" title="207"><span class="va">$array</span>.<span class="fu">Add</span>(3) &gt; <span class="va">$null</span>    <span class="co"># $array is now [1, 2, 4, 3]</span></a>
<a class="sourceLine" id="cb1-208" title="208"><span class="co"># Remove from end with index of count of objects-1; array index starts at 0</span></a>
<a class="sourceLine" id="cb1-209" title="209"><span class="va">$array</span>.<span class="fu">RemoveAt</span>(<span class="va">$array</span>.<span class="fu">Count</span>-1) <span class="co"># =&gt; 3 and array is now [1, 2, 4]</span></a>
<a class="sourceLine" id="cb1-210" title="210"><span class="co"># Let&#39;s put it back</span></a>
<a class="sourceLine" id="cb1-211" title="211"><span class="va">$array</span>.<span class="fu">Add</span>(3) &gt; <span class="va">$null</span>   <span class="co"># array is now [1, 2, 4, 3] again.</span></a>
<a class="sourceLine" id="cb1-212" title="212"></a>
<a class="sourceLine" id="cb1-213" title="213"><span class="co"># Access a list like you would any array</span></a>
<a class="sourceLine" id="cb1-214" title="214"><span class="va">$array</span>[0]   <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb1-215" title="215"><span class="co"># Look at the last element</span></a>
<a class="sourceLine" id="cb1-216" title="216"><span class="va">$array</span>[-1]  <span class="co"># =&gt; 3</span></a>
<a class="sourceLine" id="cb1-217" title="217"></a>
<a class="sourceLine" id="cb1-218" title="218"><span class="co"># Looking out of bounds returns nothing</span></a>
<a class="sourceLine" id="cb1-219" title="219"><span class="va">$array</span>[4]  <span class="co"># blank line returned</span></a>
<a class="sourceLine" id="cb1-220" title="220"></a>
<a class="sourceLine" id="cb1-221" title="221"><span class="co"># You can look at ranges with slice syntax.</span></a>
<a class="sourceLine" id="cb1-222" title="222"><span class="co"># The start index is included, the end index is not</span></a>
<a class="sourceLine" id="cb1-223" title="223"><span class="co"># (It&#39;s a closed/open range for you mathy types.)</span></a>
<a class="sourceLine" id="cb1-224" title="224"><span class="va">$array</span>[1..<span class="fu">3</span>]   <span class="co"># Return array from index 1 to 3 =&gt; [2, 4]</span></a>
<a class="sourceLine" id="cb1-225" title="225"><span class="va">$array</span>[2..-1]    <span class="co"># Return array starting from index 2 =&gt; [4, 3]</span></a>
<a class="sourceLine" id="cb1-226" title="226"><span class="va">$array</span>[0..<span class="fu">3</span>]    <span class="co"># Return array from beginning until index 3  =&gt; [1, 2, 4]</span></a>
<a class="sourceLine" id="cb1-227" title="227"><span class="va">$array</span>[0..<span class="fu">2</span>]   <span class="co"># Return array selecting every second entry =&gt; [1, 4]</span></a>
<a class="sourceLine" id="cb1-228" title="228"><span class="va">$array</span>.<span class="fu">Reverse</span>()  <span class="co"># mutates array to reverse order =&gt; [3, 4, 2, 1]</span></a>
<a class="sourceLine" id="cb1-229" title="229"><span class="co"># Use any combination of these to make advanced slices</span></a>
<a class="sourceLine" id="cb1-230" title="230"></a>
<a class="sourceLine" id="cb1-231" title="231"><span class="co"># Remove arbitrary elements from a array with &quot;del&quot;</span></a>
<a class="sourceLine" id="cb1-232" title="232"><span class="va">$array</span>.<span class="fu">Remove</span>(<span class="va">$array</span>[2])  <span class="co"># $array is now [1, 2, 3]</span></a>
<a class="sourceLine" id="cb1-233" title="233"></a>
<a class="sourceLine" id="cb1-234" title="234"><span class="co"># Insert an element at a specific index</span></a>
<a class="sourceLine" id="cb1-235" title="235"><span class="va">$array</span>.<span class="fu">Insert</span>(1, 2)  <span class="co"># $array is now [1, 2, 3] again</span></a>
<a class="sourceLine" id="cb1-236" title="236"></a>
<a class="sourceLine" id="cb1-237" title="237"><span class="co"># Get the index of the first item found matching the argument</span></a>
<a class="sourceLine" id="cb1-238" title="238"><span class="va">$array</span>.<span class="fu">IndexOf</span>(2)  <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb1-239" title="239"><span class="va">$array</span>.<span class="fu">IndexOf</span>(6)  <span class="co"># Returns -1 as &quot;outside array&quot; </span></a>
<a class="sourceLine" id="cb1-240" title="240"></a>
<a class="sourceLine" id="cb1-241" title="241"><span class="co"># You can add arrays</span></a>
<a class="sourceLine" id="cb1-242" title="242"><span class="co"># Note: values for $array and for $otherArray are not modified.</span></a>
<a class="sourceLine" id="cb1-243" title="243"><span class="va">$array</span> + <span class="va">$otherArray</span>  <span class="co"># =&gt; [1, 2, 3, 4, 5, 6]</span></a>
<a class="sourceLine" id="cb1-244" title="244"></a>
<a class="sourceLine" id="cb1-245" title="245"><span class="co"># Concatenate arrays with &quot;AddRange()&quot;</span></a>
<a class="sourceLine" id="cb1-246" title="246"><span class="va">$array</span>.<span class="fu">AddRange</span>(<span class="va">$otherArray</span>)  <span class="co"># Now $array is [1, 2, 3, 4, 5, 6]</span></a>
<a class="sourceLine" id="cb1-247" title="247"></a>
<a class="sourceLine" id="cb1-248" title="248"><span class="co"># Check for existence in a array with &quot;in&quot;</span></a>
<a class="sourceLine" id="cb1-249" title="249">1 -in <span class="va">$array</span>  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-250" title="250"></a>
<a class="sourceLine" id="cb1-251" title="251"><span class="co"># Examine length with &quot;Count&quot; (Note: &quot;Length&quot; on arrayList = each items length)</span></a>
<a class="sourceLine" id="cb1-252" title="252"><span class="va">$array</span>.<span class="fu">Count</span>  <span class="co"># =&gt; 6</span></a>
<a class="sourceLine" id="cb1-253" title="253"></a>
<a class="sourceLine" id="cb1-254" title="254"></a>
<a class="sourceLine" id="cb1-255" title="255"><span class="co"># Tuples are like arrays but are immutable.</span></a>
<a class="sourceLine" id="cb1-256" title="256"><span class="co"># To use Tuples in powershell, you must use the .NET tuple class.</span></a>
<a class="sourceLine" id="cb1-257" title="257"><span class="va">$tuple</span> = [System.<span class="fu">Tuple</span>]::Create(1, 2, 3)</a>
<a class="sourceLine" id="cb1-258" title="258"><span class="va">$tuple</span>.<span class="fu">Item</span>(0)      <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb1-259" title="259"><span class="va">$tuple</span>.<span class="fu">Item</span>(0) = 3  <span class="co"># Raises a TypeError</span></a>
<a class="sourceLine" id="cb1-260" title="260"></a>
<a class="sourceLine" id="cb1-261" title="261"><span class="co"># You can do some of the array methods on tuples, but they are limited.</span></a>
<a class="sourceLine" id="cb1-262" title="262"><span class="va">$tuple</span>.<span class="fu">Length</span>       <span class="co"># =&gt; 3</span></a>
<a class="sourceLine" id="cb1-263" title="263"><span class="va">$tuple</span> + (4, 5, 6)  <span class="co"># =&gt; Exception</span></a>
<a class="sourceLine" id="cb1-264" title="264"><span class="va">$tuple</span>[0..<span class="fu">2</span>]        <span class="co"># =&gt; $null</span></a>
<a class="sourceLine" id="cb1-265" title="265">2 -in <span class="va">$tuple</span>        <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-266" title="266"></a>
<a class="sourceLine" id="cb1-267" title="267"></a>
<a class="sourceLine" id="cb1-268" title="268"><span class="co"># Hashtables store mappings from keys to values, similar to Dictionaries.</span></a>
<a class="sourceLine" id="cb1-269" title="269"><span class="va">$emptyHash</span> = @{}</a>
<a class="sourceLine" id="cb1-270" title="270"><span class="co"># Here is a prefilled dictionary</span></a>
<a class="sourceLine" id="cb1-271" title="271"><span class="va">$filledHash</span> = @{<span class="st">&quot;one&quot;</span>= 1 </a>
<a class="sourceLine" id="cb1-272" title="272">                <span class="st">&quot;two&quot;</span>= 2 </a>
<a class="sourceLine" id="cb1-273" title="273">                <span class="st">&quot;three&quot;</span>= 3}</a>
<a class="sourceLine" id="cb1-274" title="274"></a>
<a class="sourceLine" id="cb1-275" title="275"><span class="co"># Look up values with []</span></a>
<a class="sourceLine" id="cb1-276" title="276"><span class="va">$filledHash</span>[<span class="st">&quot;one&quot;</span>]  <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb1-277" title="277"></a>
<a class="sourceLine" id="cb1-278" title="278"><span class="co"># Get all keys as an iterable with &quot;.Keys&quot;.</span></a>
<a class="sourceLine" id="cb1-279" title="279"><span class="co"># items maintain the order at which they are inserted into the dictionary.</span></a>
<a class="sourceLine" id="cb1-280" title="280"><span class="va">$filledHash</span>.<span class="fu">Keys</span>  <span class="co"># =&gt; [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span></a>
<a class="sourceLine" id="cb1-281" title="281"></a>
<a class="sourceLine" id="cb1-282" title="282"><span class="co"># Get all values as an iterable with &quot;.Values&quot;.</span></a>
<a class="sourceLine" id="cb1-283" title="283"><span class="va">$filledHash</span>.<span class="fu">Values</span>  <span class="co"># =&gt; [1, 2, 3]</span></a>
<a class="sourceLine" id="cb1-284" title="284"></a>
<a class="sourceLine" id="cb1-285" title="285"><span class="co"># Check for existence of keys or values in a hash with &quot;-in&quot;</span></a>
<a class="sourceLine" id="cb1-286" title="286"><span class="st">&quot;one&quot;</span> -in <span class="va">$filledHash</span>.<span class="fu">Keys</span>  <span class="co"># =&gt; True</span></a>
<a class="sourceLine" id="cb1-287" title="287">1 -in <span class="va">$filledHash</span>.<span class="fu">Values</span>    <span class="co"># =&gt; False</span></a>
<a class="sourceLine" id="cb1-288" title="288"></a>
<a class="sourceLine" id="cb1-289" title="289"><span class="co"># Looking up a non-existing key returns $null</span></a>
<a class="sourceLine" id="cb1-290" title="290"><span class="va">$filledHash</span>[<span class="st">&quot;four&quot;</span>]  <span class="co"># $null</span></a>
<a class="sourceLine" id="cb1-291" title="291"></a>
<a class="sourceLine" id="cb1-292" title="292"><span class="co"># Adding to a dictionary</span></a>
<a class="sourceLine" id="cb1-293" title="293"><span class="va">$filledHash</span>.<span class="fu">Add</span>(<span class="st">&quot;five&quot;</span>,5)  <span class="co"># $filledHash[&quot;five&quot;] is set to 5</span></a>
<a class="sourceLine" id="cb1-294" title="294"><span class="va">$filledHash</span>.<span class="fu">Add</span>(<span class="st">&quot;five&quot;</span>,6)  <span class="co"># exception &quot;Item with key &quot;five&quot; has already been added&quot;</span></a>
<a class="sourceLine" id="cb1-295" title="295"><span class="va">$filledHash</span>[<span class="st">&quot;four&quot;</span>] = 4 <span class="co"># $filledHash[&quot;four&quot;] is set to 4, running again does nothing</span></a>
<a class="sourceLine" id="cb1-296" title="296"></a>
<a class="sourceLine" id="cb1-297" title="297"><span class="co"># Remove keys from a dictionary with del</span></a>
<a class="sourceLine" id="cb1-298" title="298"><span class="va">$filledHash</span>.<span class="fu">Remove</span>(<span class="st">&quot;one&quot;</span>) <span class="co"># Removes the key &quot;one&quot; from filled dict</span></a>
<a class="sourceLine" id="cb1-299" title="299"></a>
<a class="sourceLine" id="cb1-300" title="300"></a>
<a class="sourceLine" id="cb1-301" title="301"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-302" title="302"><span class="co">## 3. Control Flow and Iterables</span></a>
<a class="sourceLine" id="cb1-303" title="303"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-304" title="304"></a>
<a class="sourceLine" id="cb1-305" title="305"><span class="co"># Let&#39;s just make a variable</span></a>
<a class="sourceLine" id="cb1-306" title="306"><span class="va">$someVar</span> = 5</a>
<a class="sourceLine" id="cb1-307" title="307"></a>
<a class="sourceLine" id="cb1-308" title="308"><span class="co"># Here is an if statement.</span></a>
<a class="sourceLine" id="cb1-309" title="309"><span class="co"># This prints &quot;$someVar is smaller than 10&quot;</span></a>
<a class="sourceLine" id="cb1-310" title="310"><span class="kw">if</span> (<span class="va">$someVar</span> -gt 10) {</a>
<a class="sourceLine" id="cb1-311" title="311">    <span class="fu">Write-Output</span> <span class="st">&quot;$someVar is bigger than 10.&quot;</span></a>
<a class="sourceLine" id="cb1-312" title="312">}</a>
<a class="sourceLine" id="cb1-313" title="313"><span class="kw">elseif</span> (<span class="va">$someVar</span> -lt 10) {    <span class="co"># This elseif clause is optional.</span></a>
<a class="sourceLine" id="cb1-314" title="314">    <span class="fu">Write-Output</span> <span class="st">&quot;$someVar is smaller than 10.&quot;</span></a>
<a class="sourceLine" id="cb1-315" title="315">}</a>
<a class="sourceLine" id="cb1-316" title="316"><span class="kw">else</span> {                        <span class="co"># This is optional too.</span></a>
<a class="sourceLine" id="cb1-317" title="317">    <span class="fu">Write-Output</span> <span class="st">&quot;$someVar is indeed 10.&quot;</span></a>
<a class="sourceLine" id="cb1-318" title="318">}</a>
<a class="sourceLine" id="cb1-319" title="319"></a>
<a class="sourceLine" id="cb1-320" title="320"></a>
<a class="sourceLine" id="cb1-321" title="321"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-322" title="322"><span class="co">Foreach loops iterate over arrays</span></a>
<a class="sourceLine" id="cb1-323" title="323"><span class="co">prints:</span></a>
<a class="sourceLine" id="cb1-324" title="324"><span class="co">    dog is a mammal</span></a>
<a class="sourceLine" id="cb1-325" title="325"><span class="co">    cat is a mammal</span></a>
<a class="sourceLine" id="cb1-326" title="326"><span class="co">    mouse is a mammal</span></a>
<a class="sourceLine" id="cb1-327" title="327"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-328" title="328"><span class="kw">foreach</span> (<span class="va">$animal</span> <span class="kw">in</span> (<span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>, <span class="st">&quot;mouse&quot;</span>)) {</a>
<a class="sourceLine" id="cb1-329" title="329">    <span class="co"># You can use -f to interpolate formatted strings</span></a>
<a class="sourceLine" id="cb1-330" title="330">    <span class="st">&quot;{0} is a mammal&quot;</span> -f <span class="va">$animal</span></a>
<a class="sourceLine" id="cb1-331" title="331">}</a>
<a class="sourceLine" id="cb1-332" title="332"></a>
<a class="sourceLine" id="cb1-333" title="333"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-334" title="334"><span class="co">For loops iterate over arrays and you can specify indices</span></a>
<a class="sourceLine" id="cb1-335" title="335"><span class="co">prints:</span></a>
<a class="sourceLine" id="cb1-336" title="336"><span class="co">   0 a</span></a>
<a class="sourceLine" id="cb1-337" title="337"><span class="co">   1 b</span></a>
<a class="sourceLine" id="cb1-338" title="338"><span class="co">   2 c</span></a>
<a class="sourceLine" id="cb1-339" title="339"><span class="co">   3 d</span></a>
<a class="sourceLine" id="cb1-340" title="340"><span class="co">   4 e</span></a>
<a class="sourceLine" id="cb1-341" title="341"><span class="co">   5 f</span></a>
<a class="sourceLine" id="cb1-342" title="342"><span class="co">   6 g</span></a>
<a class="sourceLine" id="cb1-343" title="343"><span class="co">   7 h</span></a>
<a class="sourceLine" id="cb1-344" title="344"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-345" title="345"><span class="va">$letters</span> = (&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;,&#39;g&#39;,&#39;h&#39;)</a>
<a class="sourceLine" id="cb1-346" title="346"><span class="kw">for</span>(<span class="va">$i</span>=0; <span class="va">$i</span> -le <span class="va">$letters</span>.<span class="fu">Count</span>-1; <span class="va">$i</span>++){</a>
<a class="sourceLine" id="cb1-347" title="347">    <span class="fu">Write-Host</span> <span class="va">$i</span>, <span class="va">$letters</span>[<span class="va">$i</span>]</a>
<a class="sourceLine" id="cb1-348" title="348">}</a>
<a class="sourceLine" id="cb1-349" title="349"></a>
<a class="sourceLine" id="cb1-350" title="350"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-351" title="351"><span class="co">While loops go until a condition is no longer met.</span></a>
<a class="sourceLine" id="cb1-352" title="352"><span class="co">prints:</span></a>
<a class="sourceLine" id="cb1-353" title="353"><span class="co">    0</span></a>
<a class="sourceLine" id="cb1-354" title="354"><span class="co">    1</span></a>
<a class="sourceLine" id="cb1-355" title="355"><span class="co">    2</span></a>
<a class="sourceLine" id="cb1-356" title="356"><span class="co">    3</span></a>
<a class="sourceLine" id="cb1-357" title="357"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-358" title="358"><span class="va">$x</span> = 0</a>
<a class="sourceLine" id="cb1-359" title="359"><span class="kw">while</span> (<span class="va">$x</span> -lt 4) {</a>
<a class="sourceLine" id="cb1-360" title="360">    <span class="fu">Write-Output</span> <span class="va">$x</span></a>
<a class="sourceLine" id="cb1-361" title="361">    <span class="va">$x</span> += 1  <span class="co"># Shorthand for x = x + 1</span></a>
<a class="sourceLine" id="cb1-362" title="362">}</a>
<a class="sourceLine" id="cb1-363" title="363"></a>
<a class="sourceLine" id="cb1-364" title="364"><span class="co"># Switch statements are more powerful compared to most languages</span></a>
<a class="sourceLine" id="cb1-365" title="365"><span class="va">$val</span> = <span class="st">&quot;20&quot;</span></a>
<a class="sourceLine" id="cb1-366" title="366"><span class="kw">switch</span>(<span class="va">$val</span>) {</a>
<a class="sourceLine" id="cb1-367" title="367">  { <span class="va">$_</span> -eq 42 }           { <span class="st">&quot;The answer equals 42&quot;</span>; <span class="kw">break</span> }</a>
<a class="sourceLine" id="cb1-368" title="368">  &#39;20&#39;                    { <span class="st">&quot;Exactly 20&quot;</span>; <span class="kw">break</span> }</a>
<a class="sourceLine" id="cb1-369" title="369">  { <span class="va">$_</span> -like &#39;s*&#39; }       { <span class="st">&quot;Case insensitive&quot;</span>; <span class="kw">break</span> }</a>
<a class="sourceLine" id="cb1-370" title="370">  { <span class="va">$_</span> -clike &#39;s*&#39;}       { <span class="st">&quot;clike, ceq, cne for case sensitive&quot;</span>; <span class="kw">break</span> }</a>
<a class="sourceLine" id="cb1-371" title="371">  { <span class="va">$_</span> -notmatch &#39;^.*$&#39;}  { <span class="st">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span>; <span class="kw">break</span> }</a>
<a class="sourceLine" id="cb1-372" title="372">  default                 { <span class="st">&quot;Others&quot;</span> }</a>
<a class="sourceLine" id="cb1-373" title="373">}</a>
<a class="sourceLine" id="cb1-374" title="374"></a>
<a class="sourceLine" id="cb1-375" title="375"><span class="co"># Handle exceptions with a try/catch block</span></a>
<a class="sourceLine" id="cb1-376" title="376"><span class="kw">try</span> {</a>
<a class="sourceLine" id="cb1-377" title="377">    <span class="co"># Use &quot;throw&quot; to raise an error</span></a>
<a class="sourceLine" id="cb1-378" title="378">    <span class="kw">throw</span> <span class="st">&quot;This is an error&quot;</span></a>
<a class="sourceLine" id="cb1-379" title="379">}</a>
<a class="sourceLine" id="cb1-380" title="380"><span class="kw">catch</span> {</a>
<a class="sourceLine" id="cb1-381" title="381">    <span class="fu">Write-Output</span> <span class="va">$Error</span>.<span class="fu">ExceptionMessage</span></a>
<a class="sourceLine" id="cb1-382" title="382">}</a>
<a class="sourceLine" id="cb1-383" title="383"><span class="kw">finally</span> {</a>
<a class="sourceLine" id="cb1-384" title="384">    <span class="fu">Write-Output</span> <span class="st">&quot;We can clean up resources here&quot;</span></a>
<a class="sourceLine" id="cb1-385" title="385">}</a>
<a class="sourceLine" id="cb1-386" title="386"></a>
<a class="sourceLine" id="cb1-387" title="387"></a>
<a class="sourceLine" id="cb1-388" title="388"><span class="co"># Writing to a file</span></a>
<a class="sourceLine" id="cb1-389" title="389"><span class="va">$contents</span> = @{<span class="st">&quot;aa&quot;</span>= 12 </a>
<a class="sourceLine" id="cb1-390" title="390">             <span class="st">&quot;bb&quot;</span>= 21}</a>
<a class="sourceLine" id="cb1-391" title="391"><span class="va">$contents</span> | <span class="fu">Export-CSV</span> <span class="st">&quot;$env:HOMEDRIVE\file.csv&quot;</span> <span class="co"># writes to a file</span></a>
<a class="sourceLine" id="cb1-392" title="392"></a>
<a class="sourceLine" id="cb1-393" title="393"><span class="va">$contents</span> = <span class="st">&quot;test string here&quot;</span></a>
<a class="sourceLine" id="cb1-394" title="394"><span class="va">$contents</span> | <span class="fu">Out-File</span> <span class="st">&quot;$env:HOMEDRIVE\file.txt&quot;</span> <span class="co"># writes to another file</span></a>
<a class="sourceLine" id="cb1-395" title="395"></a>
<a class="sourceLine" id="cb1-396" title="396"><span class="co"># Read file contents and convert to json</span></a>
<a class="sourceLine" id="cb1-397" title="397"><span class="fu">Get-Content</span> <span class="st">&quot;$env:HOMEDRIVE\file.csv&quot;</span> | <span class="fu">ConvertTo-Json</span></a>
<a class="sourceLine" id="cb1-398" title="398"></a>
<a class="sourceLine" id="cb1-399" title="399"></a>
<a class="sourceLine" id="cb1-400" title="400"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-401" title="401"><span class="co">## 4. Functions</span></a>
<a class="sourceLine" id="cb1-402" title="402"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-403" title="403"></a>
<a class="sourceLine" id="cb1-404" title="404"><span class="co"># Use &quot;function&quot; to create new functions</span></a>
<a class="sourceLine" id="cb1-405" title="405"><span class="co"># Keep the Verb-Noun naming convention for functions</span></a>
<a class="sourceLine" id="cb1-406" title="406"><span class="kw">function</span> Add-Numbers {</a>
<a class="sourceLine" id="cb1-407" title="407"> <span class="va">$args</span>[0] + <span class="va">$args</span>[1]</a>
<a class="sourceLine" id="cb1-408" title="408">}</a>
<a class="sourceLine" id="cb1-409" title="409"></a>
<a class="sourceLine" id="cb1-410" title="410">Add-Numbers 1 2 <span class="co"># =&gt; 3</span></a>
<a class="sourceLine" id="cb1-411" title="411"></a>
<a class="sourceLine" id="cb1-412" title="412"><span class="co"># Calling functions with parameters</span></a>
<a class="sourceLine" id="cb1-413" title="413"><span class="kw">function</span> Add-ParamNumbers {</a>
<a class="sourceLine" id="cb1-414" title="414"> <span class="kw">param</span>( [<span class="dt">int</span>]<span class="va">$firstNumber</span>, [<span class="dt">int</span>]<span class="va">$secondNumber</span> )</a>
<a class="sourceLine" id="cb1-415" title="415"> <span class="va">$firstNumber</span> + <span class="va">$secondNumber</span></a>
<a class="sourceLine" id="cb1-416" title="416">}</a>
<a class="sourceLine" id="cb1-417" title="417"></a>
<a class="sourceLine" id="cb1-418" title="418">Add-ParamNumbers -FirstNumber 1 -SecondNumber 2 <span class="co"># =&gt; 3 </span></a>
<a class="sourceLine" id="cb1-419" title="419"></a>
<a class="sourceLine" id="cb1-420" title="420"><span class="co"># Functions with named parameters, parameter attributes, parsable documentation</span></a>
<a class="sourceLine" id="cb1-421" title="421"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-422" title="422"><span class="co">.SYNOPSIS</span></a>
<a class="sourceLine" id="cb1-423" title="423"><span class="co">Setup a new website</span></a>
<a class="sourceLine" id="cb1-424" title="424"><span class="co">.DESCRIPTION</span></a>
<a class="sourceLine" id="cb1-425" title="425"><span class="co">Creates everything your new website needs for much win</span></a>
<a class="sourceLine" id="cb1-426" title="426"><span class="co">.PARAMETER siteName</span></a>
<a class="sourceLine" id="cb1-427" title="427"><span class="co">The name for the new website</span></a>
<a class="sourceLine" id="cb1-428" title="428"><span class="co">.EXAMPLE</span></a>
<a class="sourceLine" id="cb1-429" title="429"><span class="co">New-Website -Name FancySite -Po 5000</span></a>
<a class="sourceLine" id="cb1-430" title="430"><span class="co">New-Website SiteWithDefaultPort</span></a>
<a class="sourceLine" id="cb1-431" title="431"><span class="co">New-Website siteName 2000 # ERROR! Port argument could not be validated</span></a>
<a class="sourceLine" id="cb1-432" title="432"><span class="co">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span></a>
<a class="sourceLine" id="cb1-433" title="433"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-434" title="434"><span class="kw">function</span> New-Website() {</a>
<a class="sourceLine" id="cb1-435" title="435">    [CmdletBinding()]</a>
<a class="sourceLine" id="cb1-436" title="436">    <span class="kw">param</span> (</a>
<a class="sourceLine" id="cb1-437" title="437">        [Parameter(ValueFromPipeline=<span class="va">$true</span>, Mandatory=<span class="va">$true</span>)]</a>
<a class="sourceLine" id="cb1-438" title="438">        [Alias(&#39;name&#39;)]</a>
<a class="sourceLine" id="cb1-439" title="439">        [<span class="dt">string</span>]<span class="va">$siteName</span>,</a>
<a class="sourceLine" id="cb1-440" title="440">        [ValidateSet(3000,5000,8000)]</a>
<a class="sourceLine" id="cb1-441" title="441">        [<span class="dt">int</span>]<span class="va">$port</span> = 3000</a>
<a class="sourceLine" id="cb1-442" title="442">    )</a>
<a class="sourceLine" id="cb1-443" title="443">    <span class="kw">BEGIN</span> { <span class="fu">Write-Output</span> &#39;Creating new website(s)&#39; }</a>
<a class="sourceLine" id="cb1-444" title="444">    <span class="kw">PROCESS</span> { <span class="fu">Write-Output</span> <span class="st">&quot;name: $siteName, port: $port&quot;</span> }</a>
<a class="sourceLine" id="cb1-445" title="445">    <span class="kw">END</span> { <span class="fu">Write-Output</span> &#39;Website(s) created&#39; }</a>
<a class="sourceLine" id="cb1-446" title="446">}</a>
<a class="sourceLine" id="cb1-447" title="447"></a>
<a class="sourceLine" id="cb1-448" title="448"></a>
<a class="sourceLine" id="cb1-449" title="449"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-450" title="450"><span class="co">## 5. Modules</span></a>
<a class="sourceLine" id="cb1-451" title="451"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-452" title="452"></a>
<a class="sourceLine" id="cb1-453" title="453"><span class="co"># You can import modules and install modules</span></a>
<a class="sourceLine" id="cb1-454" title="454"><span class="co"># The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span></a>
<a class="sourceLine" id="cb1-455" title="455">Install-Module dbaTools</a>
<a class="sourceLine" id="cb1-456" title="456"><span class="fu">Import-Module</span> dbaTools</a>
<a class="sourceLine" id="cb1-457" title="457"></a>
<a class="sourceLine" id="cb1-458" title="458"><span class="va">$query</span> = <span class="st">&quot;SELECT * FROM dbo.sometable&quot;</span></a>
<a class="sourceLine" id="cb1-459" title="459"><span class="va">$queryParams</span> = @{</a>
<a class="sourceLine" id="cb1-460" title="460">    SqlInstance = &#39;testInstance&#39;</a>
<a class="sourceLine" id="cb1-461" title="461">    Database    = &#39;testDatabase&#39;</a>
<a class="sourceLine" id="cb1-462" title="462">    Query       = <span class="va">$query</span></a>
<a class="sourceLine" id="cb1-463" title="463">}</a>
<a class="sourceLine" id="cb1-464" title="464">Invoke-DbaQuery @queryParams</a>
<a class="sourceLine" id="cb1-465" title="465"></a>
<a class="sourceLine" id="cb1-466" title="466"><span class="co"># You can get specific functions from a module</span></a>
<a class="sourceLine" id="cb1-467" title="467"><span class="fu">Import-Module</span> -Function Invoke-DbaQuery</a>
<a class="sourceLine" id="cb1-468" title="468"></a>
<a class="sourceLine" id="cb1-469" title="469"></a>
<a class="sourceLine" id="cb1-470" title="470"><span class="co"># Powershell modules are just ordinary Posh files. You</span></a>
<a class="sourceLine" id="cb1-471" title="471"><span class="co"># can write your own, and import them. The name of the</span></a>
<a class="sourceLine" id="cb1-472" title="472"><span class="co"># module is the same as the name of the file.</span></a>
<a class="sourceLine" id="cb1-473" title="473"></a>
<a class="sourceLine" id="cb1-474" title="474"><span class="co"># You can find out which functions and attributes</span></a>
<a class="sourceLine" id="cb1-475" title="475"><span class="co"># are defined in a module.</span></a>
<a class="sourceLine" id="cb1-476" title="476"><span class="fu">Get-Command</span> -module dbaTools</a>
<a class="sourceLine" id="cb1-477" title="477"><span class="fu">Get-Help</span> dbaTools -Full</a>
<a class="sourceLine" id="cb1-478" title="478"></a>
<a class="sourceLine" id="cb1-479" title="479"></a>
<a class="sourceLine" id="cb1-480" title="480"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-481" title="481"><span class="co">## 6. Classes</span></a>
<a class="sourceLine" id="cb1-482" title="482"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-483" title="483"></a>
<a class="sourceLine" id="cb1-484" title="484"><span class="co"># We use the &quot;class&quot; statement to create a class</span></a>
<a class="sourceLine" id="cb1-485" title="485"><span class="kw">class</span> Instrument {</a>
<a class="sourceLine" id="cb1-486" title="486">    [<span class="dt">string</span>]<span class="va">$Type</span></a>
<a class="sourceLine" id="cb1-487" title="487">    [<span class="dt">string</span>]<span class="va">$Family</span></a>
<a class="sourceLine" id="cb1-488" title="488">}</a>
<a class="sourceLine" id="cb1-489" title="489"></a>
<a class="sourceLine" id="cb1-490" title="490"><span class="va">$instrument</span> = [Instrument]::new()</a>
<a class="sourceLine" id="cb1-491" title="491"><span class="va">$instrument</span>.<span class="fu">Type</span> = <span class="st">&quot;String Instrument&quot;</span></a>
<a class="sourceLine" id="cb1-492" title="492"><span class="va">$instrument</span>.<span class="fu">Family</span> = <span class="st">&quot;Plucked String&quot;</span></a>
<a class="sourceLine" id="cb1-493" title="493"></a>
<a class="sourceLine" id="cb1-494" title="494"><span class="va">$instrument</span></a>
<a class="sourceLine" id="cb1-495" title="495"></a>
<a class="sourceLine" id="cb1-496" title="496"><span class="co">&lt;# Output:</span></a>
<a class="sourceLine" id="cb1-497" title="497"><span class="co">Type              Family        </span></a>
<a class="sourceLine" id="cb1-498" title="498"><span class="co">----              ------        </span></a>
<a class="sourceLine" id="cb1-499" title="499"><span class="co">String Instrument Plucked String</span></a>
<a class="sourceLine" id="cb1-500" title="500"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-501" title="501"></a>
<a class="sourceLine" id="cb1-502" title="502"></a>
<a class="sourceLine" id="cb1-503" title="503"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-504" title="504"><span class="co">## 6.1 Inheritance</span></a>
<a class="sourceLine" id="cb1-505" title="505"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-506" title="506"></a>
<a class="sourceLine" id="cb1-507" title="507"><span class="co"># Inheritance allows new child classes to be defined that inherit </span></a>
<a class="sourceLine" id="cb1-508" title="508"><span class="co"># methods and variables from their parent class.</span></a>
<a class="sourceLine" id="cb1-509" title="509"></a>
<a class="sourceLine" id="cb1-510" title="510"><span class="kw">class</span> Guitar : Instrument</a>
<a class="sourceLine" id="cb1-511" title="511">{</a>
<a class="sourceLine" id="cb1-512" title="512">    [<span class="dt">string</span>]<span class="va">$Brand</span></a>
<a class="sourceLine" id="cb1-513" title="513">    [<span class="dt">string</span>]<span class="va">$SubType</span></a>
<a class="sourceLine" id="cb1-514" title="514">    [<span class="dt">string</span>]<span class="va">$ModelType</span></a>
<a class="sourceLine" id="cb1-515" title="515">    [<span class="dt">string</span>]<span class="va">$ModelNumber</span></a>
<a class="sourceLine" id="cb1-516" title="516">}</a>
<a class="sourceLine" id="cb1-517" title="517"></a>
<a class="sourceLine" id="cb1-518" title="518"><span class="va">$myGuitar</span> = [Guitar]::new()</a>
<a class="sourceLine" id="cb1-519" title="519"><span class="va">$myGuitar</span>.<span class="fu">Brand</span>       = <span class="st">&quot;Taylor&quot;</span></a>
<a class="sourceLine" id="cb1-520" title="520"><span class="va">$myGuitar</span>.<span class="fu">SubType</span>     = <span class="st">&quot;Acoustic&quot;</span></a>
<a class="sourceLine" id="cb1-521" title="521"><span class="va">$myGuitar</span>.<span class="fu">ModelType</span>   = <span class="st">&quot;Presentation&quot;</span></a>
<a class="sourceLine" id="cb1-522" title="522"><span class="va">$myGuitar</span>.<span class="fu">ModelNumber</span> = <span class="st">&quot;PS14ce Blackwood&quot;</span></a>
<a class="sourceLine" id="cb1-523" title="523"></a>
<a class="sourceLine" id="cb1-524" title="524"><span class="va">$myGuitar</span>.<span class="fu">GetType</span>()</a>
<a class="sourceLine" id="cb1-525" title="525"></a>
<a class="sourceLine" id="cb1-526" title="526"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-527" title="527"><span class="co">IsPublic IsSerial Name                                     BaseType                                               </span></a>
<a class="sourceLine" id="cb1-528" title="528"><span class="co">-------- -------- ----                                     --------                                               </span></a>
<a class="sourceLine" id="cb1-529" title="529"><span class="co">True     False    Guitar                                   Instrument  </span></a>
<a class="sourceLine" id="cb1-530" title="530"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-531" title="531"></a>
<a class="sourceLine" id="cb1-532" title="532"></a>
<a class="sourceLine" id="cb1-533" title="533"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-534" title="534"><span class="co">## 7. Advanced</span></a>
<a class="sourceLine" id="cb1-535" title="535"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb1-536" title="536"></a>
<a class="sourceLine" id="cb1-537" title="537"><span class="co"># The powershell pipeline allows things like High-Order Functions.</span></a>
<a class="sourceLine" id="cb1-538" title="538"></a>
<a class="sourceLine" id="cb1-539" title="539"><span class="co"># Group-Object is a handy cmdlet that does incredible things.</span></a>
<a class="sourceLine" id="cb1-540" title="540"><span class="co"># It works much like a GROUP BY in SQL.</span></a>
<a class="sourceLine" id="cb1-541" title="541"></a>
<a class="sourceLine" id="cb1-542" title="542"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-543" title="543"><span class="co"> The following will get all the running processes,</span></a>
<a class="sourceLine" id="cb1-544" title="544"><span class="co"> group them by Name,</span></a>
<a class="sourceLine" id="cb1-545" title="545"><span class="co"> and tell us how many instances of each process we have running.</span></a>
<a class="sourceLine" id="cb1-546" title="546"><span class="co"> Tip: Chrome and svcHost are usually big numbers in this regard.</span></a>
<a class="sourceLine" id="cb1-547" title="547"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-548" title="548"><span class="fu">Get-Process</span> | <span class="fu">Foreach-Object</span> ProcessName | <span class="fu">Group-Object</span></a>
<a class="sourceLine" id="cb1-549" title="549"></a>
<a class="sourceLine" id="cb1-550" title="550"><span class="co"># Useful pipeline examples are iteration and filtering.</span></a>
<a class="sourceLine" id="cb1-551" title="551">1..<span class="fu">10</span> | <span class="fu">ForEach-Object</span> { <span class="st">&quot;Loop number $PSITEM&quot;</span> }</a>
<a class="sourceLine" id="cb1-552" title="552">1..<span class="fu">10</span> | <span class="fu">Where-Object</span> { <span class="va">$PSITEM</span> -gt 5 } | <span class="fu">ConvertTo-Json</span></a>
<a class="sourceLine" id="cb1-553" title="553"></a>
<a class="sourceLine" id="cb1-554" title="554"><span class="co"># A notable pitfall of the pipeline is it&#39;s performance when</span></a>
<a class="sourceLine" id="cb1-555" title="555"><span class="co"># compared with other options.</span></a>
<a class="sourceLine" id="cb1-556" title="556"><span class="co"># Additionally, raw bytes are not passed through the pipeline,</span></a>
<a class="sourceLine" id="cb1-557" title="557"><span class="co"># so passing an image causes some issues.</span></a>
<a class="sourceLine" id="cb1-558" title="558"><span class="co"># See more on that in the link at the bottom.</span></a>
<a class="sourceLine" id="cb1-559" title="559"></a>
<a class="sourceLine" id="cb1-560" title="560"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-561" title="561"><span class="co"> Asynchronous functions exist in the form of jobs.</span></a>
<a class="sourceLine" id="cb1-562" title="562"><span class="co"> Typically a procedural language,</span></a>
<a class="sourceLine" id="cb1-563" title="563"><span class="co"> Powershell can operate non-blocking functions when invoked as Jobs.</span></a>
<a class="sourceLine" id="cb1-564" title="564"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-565" title="565"></a>
<a class="sourceLine" id="cb1-566" title="566"><span class="co"># This function is known to be non-optimized, and therefore slow.</span></a>
<a class="sourceLine" id="cb1-567" title="567"><span class="va">$installedApps</span> = <span class="fu">Get-CimInstance</span> -ClassName Win32_Product</a>
<a class="sourceLine" id="cb1-568" title="568"></a>
<a class="sourceLine" id="cb1-569" title="569"><span class="co"># If we had a script, it would hang at this func for a period of time.</span></a>
<a class="sourceLine" id="cb1-570" title="570"><span class="va">$scriptBlock</span> = {<span class="fu">Get-CimInstance</span> -ClassName Win32_Product}</a>
<a class="sourceLine" id="cb1-571" title="571"><span class="fu">Start-Job</span> -ScriptBlock <span class="va">$scriptBlock</span></a>
<a class="sourceLine" id="cb1-572" title="572"></a>
<a class="sourceLine" id="cb1-573" title="573"><span class="co"># This will start a background job that runs the command.</span></a>
<a class="sourceLine" id="cb1-574" title="574"><span class="co"># You can then obtain the status of jobs and their returned results.</span></a>
<a class="sourceLine" id="cb1-575" title="575"><span class="va">$allJobs</span> = <span class="fu">Get-Job</span></a>
<a class="sourceLine" id="cb1-576" title="576"><span class="va">$jobResponse</span> = <span class="fu">Get-Job</span> | <span class="fu">Receive-Job</span></a>
<a class="sourceLine" id="cb1-577" title="577"></a>
<a class="sourceLine" id="cb1-578" title="578"></a>
<a class="sourceLine" id="cb1-579" title="579"><span class="co"># Math is built in to powershell and has many functions.</span></a>
<a class="sourceLine" id="cb1-580" title="580"><span class="va">$r</span>=2</a>
<a class="sourceLine" id="cb1-581" title="581"><span class="va">$pi</span>=[math]::pi</a>
<a class="sourceLine" id="cb1-582" title="582"><span class="va">$r2</span>=[math]::pow( <span class="va">$r</span>, 2 )</a>
<a class="sourceLine" id="cb1-583" title="583"><span class="va">$area</span> = <span class="va">$pi</span>*<span class="va">$r2</span></a>
<a class="sourceLine" id="cb1-584" title="584"><span class="va">$area</span></a>
<a class="sourceLine" id="cb1-585" title="585"></a>
<a class="sourceLine" id="cb1-586" title="586"><span class="co"># To see all possibilities, check the members.</span></a>
<a class="sourceLine" id="cb1-587" title="587">[System.<span class="fu">Math</span>] | <span class="fu">Get-Member</span> -Static -MemberType All</a>
<a class="sourceLine" id="cb1-588" title="588"></a>
<a class="sourceLine" id="cb1-589" title="589"></a>
<a class="sourceLine" id="cb1-590" title="590"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb1-591" title="591"><span class="co"> This is a silly one:</span></a>
<a class="sourceLine" id="cb1-592" title="592"><span class="co"> You may one day be asked to create a func that could take $start and $end</span></a>
<a class="sourceLine" id="cb1-593" title="593"><span class="co"> and reverse anything in an array within the given range</span></a>
<a class="sourceLine" id="cb1-594" title="594"><span class="co"> based on an arbitrary array without mutating the original array.</span></a>
<a class="sourceLine" id="cb1-595" title="595"><span class="co"> Let&#39;s see one way to do that and introduce another data structure.</span></a>
<a class="sourceLine" id="cb1-596" title="596"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb1-597" title="597"></a>
<a class="sourceLine" id="cb1-598" title="598"><span class="va">$targetArray</span> = &#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;,&#39;g&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</a>
<a class="sourceLine" id="cb1-599" title="599"></a>
<a class="sourceLine" id="cb1-600" title="600"><span class="kw">function</span> Format-Range (<span class="va">$start</span>, <span class="va">$end</span>, <span class="va">$array</span>) {</a>
<a class="sourceLine" id="cb1-601" title="601">    [System.<span class="fu">Collections</span>.<span class="fu">ArrayList</span>]<span class="va">$firstSectionArray</span> = @()</a>
<a class="sourceLine" id="cb1-602" title="602">    [System.<span class="fu">Collections</span>.<span class="fu">ArrayList</span>]<span class="va">$secondSectionArray</span> = @()</a>
<a class="sourceLine" id="cb1-603" title="603">    [System.<span class="fu">Collections</span>.<span class="fu">Stack</span>]<span class="va">$stack</span> = @()</a>
<a class="sourceLine" id="cb1-604" title="604">    <span class="kw">for</span> (<span class="va">$index</span> = 0; <span class="va">$index</span> -lt <span class="va">$array</span>.<span class="fu">Count</span>; <span class="va">$index</span>++) {</a>
<a class="sourceLine" id="cb1-605" title="605">        <span class="kw">if</span> (<span class="va">$index</span> -lt <span class="va">$start</span>) {</a>
<a class="sourceLine" id="cb1-606" title="606">            <span class="va">$firstSectionArray</span>.<span class="fu">Add</span>(<span class="va">$array</span>[<span class="va">$index</span>]) &gt; <span class="va">$null</span></a>
<a class="sourceLine" id="cb1-607" title="607">        }</a>
<a class="sourceLine" id="cb1-608" title="608">        <span class="kw">elseif</span> (<span class="va">$index</span> -ge <span class="va">$start</span> -and <span class="va">$index</span> -le <span class="va">$end</span>) {</a>
<a class="sourceLine" id="cb1-609" title="609">            <span class="va">$stack</span>.<span class="fu">Push</span>(<span class="va">$array</span>[<span class="va">$index</span>])</a>
<a class="sourceLine" id="cb1-610" title="610">        }</a>
<a class="sourceLine" id="cb1-611" title="611">        <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-612" title="612">            <span class="va">$secondSectionArray</span>.<span class="fu">Add</span>(<span class="va">$array</span>[<span class="va">$index</span>]) &gt; <span class="va">$null</span></a>
<a class="sourceLine" id="cb1-613" title="613">        }</a>
<a class="sourceLine" id="cb1-614" title="614">    }</a>
<a class="sourceLine" id="cb1-615" title="615">    <span class="va">$finalArray</span> = <span class="va">$firstSectionArray</span> + <span class="va">$stack</span>.<span class="fu">ToArray</span>() + <span class="va">$secondSectionArray</span></a>
<a class="sourceLine" id="cb1-616" title="616">    <span class="kw">return</span> <span class="va">$finalArray</span></a>
<a class="sourceLine" id="cb1-617" title="617">}</a>
<a class="sourceLine" id="cb1-618" title="618"></a>
<a class="sourceLine" id="cb1-619" title="619">Format-Range 2 6 <span class="va">$targetArray</span> </a>
<a class="sourceLine" id="cb1-620" title="620"><span class="co"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span></a>
<a class="sourceLine" id="cb1-621" title="621"></a>
<a class="sourceLine" id="cb1-622" title="622"><span class="co"># The previous method works, but uses extra memory by allocating new arrays.</span></a>
<a class="sourceLine" id="cb1-623" title="623"><span class="co"># It&#39;s also kind of lengthy.</span></a>
<a class="sourceLine" id="cb1-624" title="624"><span class="co"># Let&#39;s see how we can do this without allocating a new array.</span></a>
<a class="sourceLine" id="cb1-625" title="625"><span class="co"># This is slightly faster as well.</span></a>
<a class="sourceLine" id="cb1-626" title="626"></a>
<a class="sourceLine" id="cb1-627" title="627"><span class="kw">function</span> Format-Range (<span class="va">$start</span>, <span class="va">$end</span>) {</a>
<a class="sourceLine" id="cb1-628" title="628">  <span class="kw">while</span> (<span class="va">$start</span> -lt <span class="va">$end</span>)</a>
<a class="sourceLine" id="cb1-629" title="629">  {</a>
<a class="sourceLine" id="cb1-630" title="630">      <span class="va">$temp</span> = <span class="va">$targetArray</span>[<span class="va">$start</span>]</a>
<a class="sourceLine" id="cb1-631" title="631">      <span class="va">$targetArray</span>[<span class="va">$start</span>] = <span class="va">$targetArray</span>[<span class="va">$end</span>]</a>
<a class="sourceLine" id="cb1-632" title="632">      <span class="va">$targetArray</span>[<span class="va">$end</span>] = <span class="va">$temp</span></a>
<a class="sourceLine" id="cb1-633" title="633">      <span class="va">$start</span>++</a>
<a class="sourceLine" id="cb1-634" title="634">      <span class="va">$end</span>--</a>
<a class="sourceLine" id="cb1-635" title="635">  }</a>
<a class="sourceLine" id="cb1-636" title="636">  <span class="kw">return</span> <span class="va">$targetArray</span></a>
<a class="sourceLine" id="cb1-637" title="637">}</a>
<a class="sourceLine" id="cb1-638" title="638"></a>
<a class="sourceLine" id="cb1-639" title="639">Format-Range 2 6 <span class="co"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span></a></code></pre></div>
<p>Powershell as a Tool:</p>
<p>Getting Help:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode powershell"><code class="sourceCode powershell"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Find commands</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="fu">Get-Command</span> about_* <span class="co"># alias: gcm</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="fu">Get-Command</span> -Verb Add</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="fu">Get-Alias</span> <span class="fu">ps</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="fu">Get-Alias</span> -Definition <span class="fu">Get-Process</span></a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="fu">Get-Help</span> <span class="fu">ps</span> | less <span class="co"># alias: help</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="fu">ps</span> | <span class="fu">Get-Member</span> <span class="co"># alias: gm</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="fu">Show-Command</span> <span class="fu">Get-WinEvent</span> <span class="co"># Display GUI to fill in the parameters</span></a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="fu">Update-Help</span> <span class="co"># Run as admin</span></a></code></pre></div>
<p>If you are uncertain about your environment:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode powershell"><code class="sourceCode powershell"><a class="sourceLine" id="cb3-1" title="1"><span class="fu">Get-ExecutionPolicy</span> -List</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="fu">Set-ExecutionPolicy</span> AllSigned</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># Execution policies include:</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># - Restricted: Scripts won&#39;t run.</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co"># - AllSigned: Scripts need to be signed by a trusted publisher.</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># - Unrestricted: Run all scripts.</span></a>
<a class="sourceLine" id="cb3-8" title="8">help about_Execution_Policies <span class="co"># for more info</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># Current PowerShell version:</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="va">$PSVersionTable</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode powershell"><code class="sourceCode powershell"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Calling external commands, executables, </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># and functions with the call operator.</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># Exe paths with arguments passed or containing spaces can create issues.</span></a>
<a class="sourceLine" id="cb4-4" title="4">C:\Program Files\dotnet\dotnet.<span class="fu">exe</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># The term &#39;C:\Program&#39; is not recognized as a name of a cmdlet,</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co"># function, script file, or executable program.</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># Check the spelling of the name, or if a path was included, </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co"># verify that the path is correct and try again</span></a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span></a>
<a class="sourceLine" id="cb4-11" title="11">C:\Program Files\dotnet\dotnet.<span class="fu">exe</span>    <span class="co"># returns string rather than execute</span></a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13">&amp;<span class="st">&quot;C:\Program Files\dotnet\dotnet.exe --help&quot;</span>   <span class="co"># fail</span></a>
<a class="sourceLine" id="cb4-14" title="14">&amp;<span class="st">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span> --help   <span class="co"># success</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co"># Alternatively, you can use dot-sourcing here</span></a>
<a class="sourceLine" id="cb4-16" title="16">.<span class="st">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span> --help   <span class="co"># success</span></a>
<a class="sourceLine" id="cb4-17" title="17"></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co"># the call operator (&amp;) is similar to Invoke-Expression, </span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co"># but IEX runs in current scope.</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co"># One usage of &#39;&amp;&#39; would be to invoke a scriptblock inside of your script.</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co"># Notice the variables are scoped</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="va">$i</span> = 2</a>
<a class="sourceLine" id="cb4-23" title="23"><span class="va">$scriptBlock</span> = { <span class="va">$i</span>=5; <span class="fu">Write-Output</span> <span class="va">$i</span> }</a>
<a class="sourceLine" id="cb4-24" title="24">&amp; <span class="va">$scriptBlock</span> <span class="co"># =&gt; 5</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="va">$i</span> <span class="co"># =&gt; 2</span></a>
<a class="sourceLine" id="cb4-26" title="26"></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="fu">invoke-expression</span> &#39; <span class="va">$i</span>=5; <span class="fu">Write-Output</span> <span class="va">$i</span> &#39; <span class="co"># =&gt; 5</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="va">$i</span> <span class="co"># =&gt; 5</span></a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co"># Alternatively, to preserve changes to public variables</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co"># you can use &quot;Dot-Sourcing&quot;. This will run in the current scope.</span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="va">$x</span>=1</a>
<a class="sourceLine" id="cb4-33" title="33">&amp;{<span class="va">$x</span>=2};<span class="va">$x</span> <span class="co"># =&gt; 1</span></a>
<a class="sourceLine" id="cb4-34" title="34"></a>
<a class="sourceLine" id="cb4-35" title="35">.{<span class="va">$x</span>=2};<span class="va">$x</span> <span class="co"># =&gt; 2</span></a>
<a class="sourceLine" id="cb4-36" title="36"></a>
<a class="sourceLine" id="cb4-37" title="37"></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co"># Remoting into computers is easy.</span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="fu">Enter-PSSession</span> -ComputerName RemoteComputer</a>
<a class="sourceLine" id="cb4-40" title="40"></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co"># Once remoted in, you can run commands as if you&#39;re local.</span></a>
<a class="sourceLine" id="cb4-42" title="42">RemoteComputer\<span class="fu">PS</span>&gt; <span class="fu">Get-Process</span> powershell</a>
<a class="sourceLine" id="cb4-43" title="43"></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             </span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">-------  ------    -----      -----     ------     --  -- -----------                                             </span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">   1096      44   156324     179068      29.92  11772   1 powershell                                              </span></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">    545      25    49512      49852             25348   0 powershell </span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb4-50" title="50">RemoteComputer\<span class="fu">PS</span>&gt; <span class="fu">Exit-PSSession</span></a>
<a class="sourceLine" id="cb4-51" title="51"></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb4-53" title="53"><span class="co"> Powershell is an incredible tool for Windows management and Automation.</span></a>
<a class="sourceLine" id="cb4-54" title="54"><span class="co"> Let&#39;s take the following scenario:</span></a>
<a class="sourceLine" id="cb4-55" title="55"><span class="co"> You have 10 servers.</span></a>
<a class="sourceLine" id="cb4-56" title="56"><span class="co"> You need to check whether a service is running on all of them.</span></a>
<a class="sourceLine" id="cb4-57" title="57"><span class="co"> You can RDP and log in, or PSSession to all of them, but why?</span></a>
<a class="sourceLine" id="cb4-58" title="58"><span class="co"> Check out the following</span></a>
<a class="sourceLine" id="cb4-59" title="59"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb4-60" title="60"></a>
<a class="sourceLine" id="cb4-61" title="61"><span class="va">$serverList</span> = @(</a>
<a class="sourceLine" id="cb4-62" title="62">    &#39;server1&#39;,</a>
<a class="sourceLine" id="cb4-63" title="63">    &#39;server2&#39;,</a>
<a class="sourceLine" id="cb4-64" title="64">    &#39;server3&#39;,</a>
<a class="sourceLine" id="cb4-65" title="65">    &#39;server4&#39;,</a>
<a class="sourceLine" id="cb4-66" title="66">    &#39;server5&#39;,</a>
<a class="sourceLine" id="cb4-67" title="67">    &#39;server6&#39;,</a>
<a class="sourceLine" id="cb4-68" title="68">    &#39;server7&#39;,</a>
<a class="sourceLine" id="cb4-69" title="69">    &#39;server8&#39;,</a>
<a class="sourceLine" id="cb4-70" title="70">    &#39;server9&#39;,</a>
<a class="sourceLine" id="cb4-71" title="71">    &#39;server10&#39;</a>
<a class="sourceLine" id="cb4-72" title="72">)</a>
<a class="sourceLine" id="cb4-73" title="73"></a>
<a class="sourceLine" id="cb4-74" title="74">[scriptblock]<span class="va">$script</span> = {</a>
<a class="sourceLine" id="cb4-75" title="75">    <span class="fu">Get-Service</span> -DisplayName &#39;Task Scheduler&#39;</a>
<a class="sourceLine" id="cb4-76" title="76">}</a>
<a class="sourceLine" id="cb4-77" title="77"></a>
<a class="sourceLine" id="cb4-78" title="78"><span class="kw">foreach</span> (<span class="va">$server</span> <span class="kw">in</span> <span class="va">$serverList</span>) {</a>
<a class="sourceLine" id="cb4-79" title="79">    <span class="va">$cmdSplat</span> = @{</a>
<a class="sourceLine" id="cb4-80" title="80">        ComputerName  = <span class="va">$server</span></a>
<a class="sourceLine" id="cb4-81" title="81">        JobName       = &#39;checkService&#39;</a>
<a class="sourceLine" id="cb4-82" title="82">        ScriptBlock   = <span class="va">$script</span></a>
<a class="sourceLine" id="cb4-83" title="83">        AsJob         = <span class="va">$true</span></a>
<a class="sourceLine" id="cb4-84" title="84">        ErrorAction   = &#39;SilentlyContinue&#39;</a>
<a class="sourceLine" id="cb4-85" title="85">    }</a>
<a class="sourceLine" id="cb4-86" title="86">    <span class="fu">Invoke-Command</span> @cmdSplat | <span class="fu">Out-Null</span></a>
<a class="sourceLine" id="cb4-87" title="87">}</a>
<a class="sourceLine" id="cb4-88" title="88"></a>
<a class="sourceLine" id="cb4-89" title="89"><span class="co">&lt;#</span></a>
<a class="sourceLine" id="cb4-90" title="90"><span class="co"> Here we&#39;ve invoked jobs across many servers.</span></a>
<a class="sourceLine" id="cb4-91" title="91"><span class="co"> We can now Receive-Job and see if they&#39;re all running.</span></a>
<a class="sourceLine" id="cb4-92" title="92"><span class="co"> Now scale this up 100x as many servers :)</span></a>
<a class="sourceLine" id="cb4-93" title="93"><span class="co">#&gt;</span></a></code></pre></div>
<p>Interesting Projects</p>
<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> PowerShell tutorials</li>
<li><a href="https://powershellexplained.com/">KevinMarquette’s Powershell Blog</a> Excellent blog that goes into great detail on Powershell</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet for PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> A bash inspired readline implementation for PowerShell (So good that it now ships with Windows10 by default!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Fancy Git Prompt (Recommended!)</li>
<li><a href="https://github.com/JanDeDobbeleer/oh-my-posh">Oh-My-Posh</a> Shell customization similar to the popular Oh-My-Zsh on Mac</li>
<li><a href="https://github.com/psake/psake">PSake</a> Build automation tool</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD Testing Framework</li>
<li><a href="https://github.com/tkellogg/Jump-Location">Jump-Location</a> Powershell <code>cd</code> that reads your mind</li>
<li><a href="https://github.com/Pscx/Pscx">PowerShell Community Extensions</a></li>
<li><a href="https://github.com/PowerShell/PowerShell/issues/1908">More on the Powershell Pipeline Issue</a></li>
</ul>
</body>
</html>
